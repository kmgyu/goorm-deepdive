
EC2 Redis Cluster를 만들어주자.

단일 서버에서 Redis Cluster를 구축해준다.
여기선 t3.micro를 사용했기 때문에 cpu 수에 맞춰 2개를 이용하였다.

Redis Cluster 구축하기

참고해볼 것.
https://co-de.tistory.com/24
https://liltdevs.tistory.com/208
https://velog.io/@tngusqkr1/Redis-cluster-%EC%84%A4%EC%A0%95-1

[참고자료](https://velog.io/@pjh612/Docker-compose%EB%A1%9C-Redis-cluster-%EA%B5%AC%EC%84%B1%ED%95%98%EA%B8%B0-%EB%8F%84%EC%BB%A4-%EC%99%B8%EB%B6%80%EC%97%90%EC%84%9C-%EC%A0%91%EC%86%8D-%ED%8A%B8%EB%9F%AC%EB%B8%94-%EC%8A%88%ED%8C%85)
docker-compose를 활용해 redis cluster를 구축했다.
위 참고자료에서는 docker-network를 거치지 않고 호스트 네트워크와 도커 네트워크를 구분지었다고 한다...
호스트 ip 정보를 이용해 그냥 직접 연결해버린 것 같다.

여기선 그냥 docker networking 쓰겠다.

더 알아보니, redis-cluster 이미지의 경우 grokzen이랑 bitnami 방식으로 갈린다.
grokzen은 자동으로 한 컨테이너 안에서 여러 개를 구성해주는 것이고, bitnami는 각 클러스터 노드를 컨테이너 단위로 분리하여 작동한다.

참고로 레디스 클러스터링해도 결국 SPOF인 건 변함없다...!

redis.conf
귀찮아서 6379와 16379로 통일시켜줬다.
이쪽은 잘 모르니 gpt로 일단 보일러 플레이트 만들고 참고자료를 추가로 찾고있다...
```
# -------------------------------
# 기본 네트워크 설정
# -------------------------------
bind 0.0.0.0
protected-mode no

# -------------------------------
# 포트 설정
# -------------------------------
# 노드별 고유 포트 (예: 6479, 6480 등)
port 6379                     

# -------------------------------
# 클러스터 모드 설정
# -------------------------------
cluster-enabled yes
cluster-config-file nodes.conf
cluster-node-timeout 5000

# 클러스터 내부 통신용 포트 (data port + 10000)
cluster-announce-port 6379
cluster-announce-bus-port 16379

# 클러스터에서 다른 노드와 통신할 때 알려줄 IP
cluster-announce-ip redis-node-1

# -------------------------------
# 지속성 (옵션)
# -------------------------------
appendonly yes
appendfsync everysec
```

였는데...
```
1:C 25 Oct 2025 14:43:11.204 # Fatal error, can't open config file '/redis/redis.conf': No such file or directory
```
못 열고있다!

알고보니 port 부분을 `#`로 한 라인에 같이 붙여줘서 이 사단이 난거였다. 바로 해결했다.