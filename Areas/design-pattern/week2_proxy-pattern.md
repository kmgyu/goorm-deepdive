
> ê°€ìƒ í”„ë¡ì‹œ, ë³´í˜¸ í”„ë¡ì‹œ ìª½ì€ ì´í•´ê°€ ë” í•„ìš”í•¨.
> 
# í”„ë¡ì‹œ íŒ¨í„´

> **í”„ë¡ì‹œ íŒ¨í„´**ì€ íŠ¹ì • ê°ì²´ë¡œì˜ ì ‘ê·¼ì„ ì œì–´í•˜ëŠ” ëŒ€ë¦¬ì¸(ê°ì²´ì˜ ëŒ€ë³€ì¸)ì„ ì œê³µí•œë‹¤.

- í´ë¼ì´ì–¸íŠ¸ëŠ” ëŒ€ë¦¬ì¸ì¸ í”„ë¡ì‹œê°€ ë§ˆì¹˜ ì§„ì§œ ê°ì²´ë¼ê³  ìƒê°í•˜ê³  ë°ì´í„°ë¥¼ ì£¼ê³  ë°›ëŠ”ë‹¤.
- í´ë¼ì´ì–¸íŠ¸ì™€ ì§„ì§œ ê°ì²´ê°€ ì§ì ‘ ë°ì´í„°ë¥¼ ì£¼ê³ ë°›ì„ ìˆ˜ ì—†ëŠ” ê²½ìš°ì— ë‘˜ ì‚¬ì´ì˜ ì ‘ê·¼ì„ ì œì–´í•˜ëŠ” ì—­í• ì„ í•œë‹¤.

ì£¼ë¡œ ë‹¤ìŒê³¼ ê°™ì€ ìƒí™©ì—ì„œ ì‚¬ìš©ëœë‹¤.

- í´ë¼ì´ì–¸íŠ¸ì™€ ì‹¤ì œ ê°ì²´ ì‚¬ì´ì˜ ì§ì ‘ì ì¸ ì ‘ê·¼ì´ ì œí•œë˜ëŠ” ê²½ìš°
- ê°ì²´ì˜ ìƒì„± ë¹„ìš©ì´ ë†’ì€ ê²½ìš°
- ê°ì²´ ì ‘ê·¼ ì‹œ ì¸ì¦, ë¡œê¹…, ë™ê¸°í™” ë“±ì˜ ë¶€ê°€ ì‘ì—…ì´ í•„ìš”í•œ ê²½ìš°

## êµ¬ì¡°

[![á„á…³á†¯á„…á…¢á„‰á…³ á„ƒá…¡á„‹á…µá„‹á…¥á„€á…³á„…á…¢á†·](https://user-images.githubusercontent.com/86337233/212689080-b46f70ca-0561-4bdd-b6c5-3c7f59945506.png)](https://user-images.githubusercontent.com/86337233/212689080-b46f70ca-0561-4bdd-b6c5-3c7f59945506.png)
*í”„ë¡ì‹œ íŒ¨í„´ì˜ í´ë˜ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨*

Subject
- í”„ë¡ì‹œì™€ ì§„ì§œ ì„œë¹„ìŠ¤ ê°ì²´ ëª¨ë‘ê°€ êµ¬í˜„í•´ì•¼ í•˜ëŠ” ì¸í„°í˜ì´ìŠ¤.
- ì´ ì¸í„°í˜ì´ìŠ¤ë¥¼ í†µí•´ í”„ë¡ì‹œëŠ” Serviceì™€ ë˜‘ê°™ì€ í˜•íƒœë¡œ ìœ„ì¥í•  ìˆ˜ ìˆë‹¤.

RealSubject
- ì§„ì§œ ì‘ì—…ì„ ì²˜ë¦¬í•˜ëŠ” ê°ì²´.

Proxy
- ì„œë¹„ìŠ¤ ê°ì²´ì˜ ëŒ€ë³€ì¸ ì—­í• ì„ í•˜ë©´ì„œ ì´ ê°ì²´ë¡œì˜ ì ‘ê·¼ì„ ì œì–´í•œë‹¤.
- ì„œë¹„ìŠ¤ ê°ì²´ì˜ ë ˆí¼ëŸ°ìŠ¤ê°€ ë“¤ì–´ìˆì–´, í´ë¼ì´ì–¸íŠ¸ê°€ ì„œë¹„ìŠ¤ê°€ í•„ìš”í•˜ë‹¤ë©´ ì´ ë ˆí¼ëŸ°ìŠ¤ë¥¼ ì‚¬ìš©í•´ì„œ ì„œë¹„ìŠ¤ ê°ì²´ì— ìš”ì²­ì„ ì „ë‹¬í•œë‹¤.
- Proxyì—ì„œ RealSubjectì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ê±°ë‚˜, ê·¸ ê°ì²´ì˜ ìƒì„± ê³¼ì •ì— ê´€ì—¬í•˜ëŠ” ê²½ìš°ê°€ ë§ë‹¤.


**í”„ë¡ì‹œì˜ ì¢…ë¥˜**
> í—¤ë“œ í¼ìŠ¤íŠ¸ ë””ìì¸ íŒ¨í„´ì—ì„œëŠ” ë‹¤ì–‘í•œ ì¢…ë¥˜ì˜ í”„ë¡ì‹œë¥¼ ì„¤ëª…í•œë‹¤.
> ê³µí†µì ìœ¼ë¡œ í´ë¼ì´ì–¸íŠ¸ê°€ ì‹¤ì œ ê°ì²´ì˜ ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•˜ë©´ ê·¸ í˜¸ì¶œì„ í”„ë¡ì‹œê°€ ì¤‘ê°„ì— ê°€ë¡œì±ˆë‹¤.

ì˜ˆì œ ì½”ë“œëŠ” ë³´í˜¸ í”„ë¡ì‹œ ê¹Œì§€ë§Œ ì„¤ëª…í•œë‹¤.

`ì›ê²© í”„ë¡ì‹œ`
- ì›ê²© ê°ì²´ë¡œì˜ ì ‘ê·¼ì„ ì œì–´í•¨.

`ê°€ìƒ í”„ë¡ì‹œ`
- ìƒì„±í•˜ê¸° í˜ë“  ìì› ì¦‰, ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë§Œë“œëŠ” ë° ë§ì€ ë¹„ìš©ì´ ë“œëŠ” ê°ì²´ë¡œì˜ ì ‘ê·¼ì„ ì œì–´í•¨.

`ë³´í˜¸ í”„ë¡ì‹œ`
- ì ‘ê·¼ ê¶Œí•œì´ í•„ìš”í•œ ìì›ìœ¼ë¡œì˜ ì ‘ê·¼ì„ ì œì–´í•¨.

`ë°©í™”ë²½ í”„ë¡ì‹œ(Firewall Proxy)`  
- ì¼ë ¨ì˜ ë„¤íŠ¸ì›Œí¬ ìì›ìœ¼ë¡œì˜ ì ‘ê·¼ì„ ì œì–´
- ì£¼ì œ(Subject)ë¥¼ â€˜ë‚˜ìœâ€™ í´ë¼ì´ì–¸íŠ¸ë¡œë¶€í„° ë³´í˜¸í•´ì¤Œ

`ìŠ¤ë§ˆíŠ¸ ë ˆí¼ëŸ°ìŠ¤ í”„ë¡ì‹œ(Smart Reference Proxy)`
- ì£¼ì œê°€ ì°¸ì¡°ë  ë•Œë§ˆë‹¤ ì¶”ê°€ í–‰ë™ì„ ì œê³µí•¨.

`ìºì‹± í”„ë¡ì‹œ(Caching Proxy)`  
- ë¹„ìš©ì´ ë§ì´ ë“œëŠ” ì‘ì—…ì˜ ê²°ê³¼ë¥¼ ì„ì‹œë¡œ ì €ì¥í•´ì¤Œ
- ì—¬ëŸ¬ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ê²°ê³¼ë¥¼ ê³µìœ í•˜ê²Œ í•´ì¤Œ  
ê³„ì‚° ì‹œê°„ê³¼ ë„¤íŠ¸ì›Œí¬ ì§€ì—°ì„ ì¤„ì—¬ì£¼ëŠ” íš¨ê³¼ê°€ ì¡´ì¬

`ë™ê¸°í™” í”„ë¡ì‹œ(Synchronization Proxy)`  
- ì—¬ëŸ¬ ìŠ¤ë ˆë“œì—ì„œ ì£¼ì œì— ì ‘ê·¼í•  ë•Œ ì•ˆì „í•˜ê²Œ ì‘ì—…ì„ ì²˜ë¦¬í•  ìˆ˜ ìˆë„ë¡ í•´ì¤Œ

`ë³µì¡ë„ ìˆ¨ê¹€ í”„ë¡ì‹œ(Complexity Hiding Proxy)`  
- ë³µì¡í•œ í´ë˜ìŠ¤ì˜ ì§‘í•©ìœ¼ë¡œì˜ ì ‘ê·¼ì„ ì œì–´í•˜ê³ , ê·¸ ë³µì¡ë„ë¥¼ ìˆ¨ê²¨ì¤Œ
- ê·¸ íŠ¹ì„±ìœ¼ë¡œ ì¸í•´ `í¼ì‚¬ë“œ í”„ë¡ì‹œ(Facade Proxy)`ë¼ê³ ë„ ì¹­í•œë‹¤.
> **vs. í¼ì‚¬ë“œ íŒ¨í„´**
> í”„ë¡ì‹œëŠ” ì ‘ê·¼ì„ ì œì–´,Â í¼ì‚¬ë“œ íŒ¨í„´ì€ **ëŒ€ì²´ ì¸í„°í˜ì´ìŠ¤**ë§Œ ì œê³µí•¨

`ì§€ì—° ë³µì‚¬ í”„ë¡ì‹œ(Copy-On-Write Proxy)`  
ê°ì²´ì˜ ë³µì‚¬ë¥¼ ì œì–´(í´ë¼ì´ì–¸íŠ¸ì—ì„œ í•„ìš”ë¡œ í•  ë•Œê¹Œì§€ ê°ì²´ê°€ ë³µì‚¬ë˜ëŠ” ê²ƒì„ ì§€ì—°ì‹œí‚´)

## ì›ê²© í”„ë¡ì‹œ
> ì›ê²© í”„ë¡ì‹œëŠ” ì›ê²© ê°ì²´ì˜ ë¡œì»¬ ëŒ€ë³€ì ì—­í• ì„ í•œë‹¤.

1. í”„ë¡ì‹œì˜ ë©”ì„œë“œ í˜¸ì¶œ
2. í˜¸ì¶œì´ ë„¤íŠ¸ì›Œí¬ë¡œ ì „ë‹¬ë˜ì–´ ì›ê²© ê°ì²´ì˜ ë©”ì„œë“œê°€ í˜¸ì¶œëœë‹¤.
3. ê·¸ ê²°ê³¼ëŠ” í”„ë¡ì‹œë¥¼ ê±°ì³ì„œ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì „ë‹¬ëœë‹¤.


ë½‘ê¸° ê¸°ê³„ íšŒì‚¬ì˜ CEOê°€ ìì‹ ì˜ ì„œë²„ì—ì„œ ë½‘ê¸° ê¸°ê³„ë¥¼ ëª¨ë‹ˆí„°ë§í•˜ê³  ì‹¶ì–´í•˜ëŠ” ìƒí™©ì„ ê°€ì •í•´ë³¸ë‹¤.
ì´ë•Œ ë½‘ê¸° ê¸°ê³„ë“¤ì€ ì„œë¡œ ë‹¤ë¥¸ ì„œë²„ì— ë°°í¬ë˜ì–´ ìˆëŠ” ìƒíƒœì´ë‹¤. ë”°ë¼ì„œ ë½‘ê¸° ê¸°ê³„ë“¤ì„ CEOì˜ ì„œë²„ì—ì„œ ëª¨ë‹ˆí„°ë§ í•  ìˆ˜ ìˆê²Œ í•´ì•¼ í•˜ëŠ” ìƒí™©ì´ë‹¤.
ì´ ìƒí™©ì˜ í•´ê²°ì„ ìœ„í•´ ì›ê²© í”„ë¡ì‹œë¥¼ ì‚¬ìš©í•œë‹¤.

`ì›ê²© ê°ì²´`ëŠ” ë‹¤ë¥¸ ìë°” ê°€ìƒ ë¨¸ì‹ ì˜ í™ì—ì„œ ì‚´ê³  ìˆëŠ” ê°ì²´(ì¦‰,Â **ë‹¤ë¥¸ ì£¼ì†Œ ê³µê°„ì—ì„œ ëŒì•„ê°€ê³  ìˆëŠ” ê°ì²´**)ë¥¼ ë§í•˜ë©°, ì´ë•ŒÂ `í™(Heap) ë©”ëª¨ë¦¬`ëŠ” ìë°” í”„ë¡œê·¸ë¨ì´ ì‹¤í–‰ë˜ë©´ì„œ ë™ì ìœ¼ë¡œ ìƒì„±ëœ ê°ì²´(new ì—°ì‚°ìë¡œ ìƒì„±ëœ ê°ì²´ ë˜ëŠ” ì¸ìŠ¤í„´ìŠ¤)ê°€ ì €ì¥ë˜ëŠ” ê³µê°„ì´ë‹¤.
`ë¡œì»¬ ëŒ€ë³€ì`ëŠ” ì–´ë–¤ ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•˜ë©´,Â **ë‹¤ë¥¸ ì›ê²© ê°ì²´ì—ê²Œ ê·¸ ë©”ì†Œë“œ í˜¸ì¶œì„ ì „ë‹¬í•´ì£¼ëŠ” ê°ì²´**ë¥¼ ë§í•œë‹¤.

ì•„ë˜ ê·¸ë¦¼ì²˜ëŸ¼ ë„¤íŠ¸ì›Œí¬ í†µì‹ ê³¼ ê´€ë ¨ëœ ì €ìˆ˜ì¤€ ì‘ì—…ì€Â `í”„ë¡ì‹œ ê°ì²´`ì—ì„œ ì²˜ë¦¬í•´ì¤€ë‹¤.
  
![ì›ê²©](https://user-images.githubusercontent.com/86337233/212689075-4fd55f45-443e-48d4-a0bf-bf02ebdb91a3.png)

1. `í´ë¼ì´ì–¸íŠ¸ ê°ì²´(Client object)`ëŠ” ì›ê²© ì„œë¹„ìŠ¤ ê°ì²´ì˜ ë©”ì†Œë“œ í˜¸ì¶œì„ í•˜ëŠ” ê²ƒì²˜ëŸ¼ í–‰ë™í•˜ì§€ë§Œ, ì‹¤ì œë¡œëŠ” ë¡œì»¬ í™ì— ë“¤ì–´ìˆëŠ” í´ë¼ì´ì–¸íŠ¸ ë³´ì¡° ê°ì²´ì˜ ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•˜ê³  ìˆëŠ” ê²ƒì´ë‹¤.
2. `í´ë¼ì´ì–¸íŠ¸ ë³´ì¡° ê°ì²´(Client helper, ì¦‰ í”„ë¡ì‹œ ê°ì²´)`ëŠ” ì„œë²„ì— ì—°ë½ì„ ì·¨í•˜ê³ , ë©”ì„œë“œ í˜¸ì¶œì— ê´€í•œ ì •ë³´ë¥¼ ì „ë‹¬í•œ í›„ì— ì„œë²„ë¡œë¶€í„° ë¦¬í„´ë˜ëŠ” ì •ë³´ë¥¼ ê¸°ë‹¤ë¦°ë‹¤.
3. `ì„œë¹„ìŠ¤ ë³´ì¡° ê°ì²´(Service helper)`ëŠ” í´ë¼ì´ì–¸íŠ¸ ë³´ì¡° ê°ì²´ë¡œë¶€í„° ìš”ì²­ì„ ë°›ê³ , ì´ë¥¼ í•´ì„í•´ì„œ ì„œë¹„ìŠ¤ ê°ì²´ì— ìˆëŠ” ë©”ì„œë“œë¥¼ í˜¸ì¶œí•œë‹¤.  
    _(ì„œë¹„ìŠ¤ ê°ì²´ëŠ” ê·¸ ë©”ì„œë“œ í˜¸ì¶œì´ ì›ê²© í´ë¼ì´ì–¸íŠ¸ê°€ ì•„ë‹Œ, ë¡œì»¬ ê°ì²´ë¡œë¶€í„° ë“¤ì–´ì˜¨ë‹¤ê³  ìƒê°í•¨)_
4. `ì„œë¹„ìŠ¤ ê°ì²´(Service object)`ì—ëŠ” ì‹¤ì œë¡œ ì‘ì—…ì„ ì²˜ë¦¬í•˜ëŠ” ë©”ì„œë“œê°€ ë“¤ì–´ìˆìœ¼ë¯€ë¡œ, í˜¸ì¶œëœ ë©”ì„œë“œì˜ ë¦¬í„´ê°’ì„ ì„œë¹„ìŠ¤ ë³´ì¡° ê°ì²´ì—ê²Œ ì „ë‹¬í•œë‹¤.
5. ì„œë¹„ìŠ¤ ë³´ì¡° ê°ì²´ëŠ” ì„œë¹„ìŠ¤ ê°ì²´ë¡œë¶€í„° ë¦¬í„´ê°’ì„ ë°›ì•„ì„œÂ Socketì˜ ì¶œë ¥ ìŠ¤íŠ¸ë¦¼ìœ¼ë¡œ í´ë¼ì´ì–¸íŠ¸ ë³´ì¡° ê°ì²´ì—ê²Œ ì „ì†¡í•œë‹¤.
6. í´ë¼ì´ì–¸íŠ¸ ë³´ì¡° ê°ì²´ëŠ” ê·¸ ì •ë³´ë¥¼ í•´ì„í•´ì„œ í´ë¼ì´ì–¸íŠ¸ ê°ì²´ì— ë¦¬í„´í•œë‹¤.

ì´ë•Œ Client helperì™€ Service helperëŠ” í†µì‹ ì„ ìœ„í•´ ìë°” RMI í”„ë¡œí† ì½œì„ ì´ìš©í•œë‹¤.

### ìë°” RMI

ìë°”ì—ì„œëŠ”Â `RMI(Remote Method Invocation, ì›ê²© ë©”ì†Œë“œ í˜¸ì¶œ)`ë¥¼ í†µí•´ ì›ê²© JVMì— ìˆëŠ” ê°ì²´ë¥¼ ì°¾ì•„ì„œ ê·¸ ê°ì²´ì˜ ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆë‹¤.

RMIê°€ í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë¹„ìŠ¤ ë³´ì¡° ê°ì²´ë¥¼ ë§Œë“¤ì–´ ì¤€ë‹¤.

| `Stub` (í´ë¼ì´ì–¸íŠ¸ ë³´ì¡° ê°ì²´, Proxy)  | ë¡œì»¬ì—ì„œ ì›ê²© ê°ì²´ë¥¼ ëŒ€ì‹ í•¨    |
| ---------------------------- | ------------------ |
| `Skeleton` (ì„œë²„ ë³´ì¡° ê°ì²´, Proxy) | ìš”ì²­ì„ ì‹¤ì œ ê°ì²´ë¡œ ì „ë‹¬      |
| `Remote Interface`           | ì›ê²© í˜¸ì¶œ ê°€ëŠ¥í•œ ë©”ì„œë“œë¥¼ ì •ì˜  |
| `Serializable`               | ë„¤íŠ¸ì›Œí¬ ì „ì†¡ì„ ìœ„í•œ ì§ë ¬í™” í•„ìš” |

RMIë¥¼ ì‚¬ìš©í•˜ë©´ ë„¤íŠ¸ì›Œí‚¹ì´ë‚˜ ì…ì¶œë ¥ê³¼ ê´€ë ¨ëœ ì½”ë“œë¥¼ ì‘ì„±í•˜ì§€ ì•Šì•„ë„ ë˜ëŠ” ì¥ì ì´ ìˆë‹¤.
í´ë¼ì´ì–¸íŠ¸ê°€ ì›ê²© ê°ì²´ë¥¼ ì°¾ì•„ ì ‘ê·¼í•˜ê¸° ìœ„í•œ lookup ë©”ì†Œë“œë„ RMIì—ì„œ ì œê³µí•œë‹¤.

### êµ¬í˜„ ì˜ˆì œ - ì›ê²© í”„ë¡ì‹œ

1. ì›ê²© ì¸í„°í˜ì´ìŠ¤ ë§Œë“¤ê¸°
2. ì„œë¹„ìŠ¤ êµ¬í˜„ í´ë˜ìŠ¤ ë§Œë“¤ê¸°
3. RMI ë ˆì§€ìŠ¤íŠ¸ë¦¬(rmiregistry) ì‹¤í–‰í•˜ê¸°
    (í´ë¼ì´ì–¸íŠ¸ëŠ” rmiregistryë¥¼ í†µí•´ì„œÂ `ìŠ¤í…(í”„ë¡ì‹œ)`ì„ ë°›ì•„ê°)
4. ì›ê²© ì„œë¹„ìŠ¤ ì‹¤í–‰í•˜ê¸°

#### 1ë‹¨ê³„ : ì›ê²© ì¸í„°í˜ì´ìŠ¤ ë§Œë“¤ê¸°

1. `java.rmi.Remote`Â í™•ì¥

```java
public interface GumballMachineRemote extends Remote {
```


2. ëª¨ë“  ë©”ì„œë“œë¥¼Â `RemoteException`ì„ ë˜ì§€ë„ë¡ ì„ ì–¸

- ìŠ¤í…ì´ ì…ì¶œë ¥ ì‘ì—…ì„ ì²˜ë¦¬í•  ë•Œ ì˜ˆì™¸ ì‚¬í•­ë“¤ì´ ë°œìƒí•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ë¯¸ë¦¬ ëŒ€ë¹„í•´ì•¼ í•œë‹¤.

```java
import java.rmi.*;
// ì›ê²© ì„œë¹„ìŠ¤ë¡œ ë§Œë“¤ê¸° ìœ„í•´ rmiì˜ Remote ì¸í„°í˜ì´ìŠ¤ë¥¼ ìƒì†í•©ë‹ˆë‹¤. 
public interface GumballMachineRemote extends Remote {
	// ë„¤íŠ¸ì›Œí¬ ì—ëŸ¬ë¥¼ ëŒ€ë¹„í•´ RemoteExceptionì„ í•­ìƒ ë˜ì ¸ì•¼ í•©ë‹ˆë‹¤.
	// ë¦¬í„´ê°’ì„ ë„¤íŠ¸ì›Œí¬ë¡œ ì „ì†¡í•˜ê¸° ìœ„í•´ ë¦¬í„´ê°’ì€ í•­ìƒ ì›ì‹œ í˜•ì‹ ë˜ëŠ” Serializableì´ì–´ì•¼ í•©ë‹ˆë‹¤.
	public int getCount() throws RemoteException;
	public String getLocation() throws RemoteException;
	public State getState() throws RemoteException;
}
```

3. ì›ê²© ë©”ì„œë“œì˜ ì¸ìì™€ ë¦¬í„´ê°’ì€ ë°˜ë“œì‹œÂ `ì›ì‹œ í˜•ì‹(primitive)`Â ë˜ëŠ”Â `Serializable í˜•ì‹`ìœ¼ë¡œ ì„ ì–¸
- ì›ê²© ë©”ì†Œë“œì˜ ì¸ìì™€ ë¦¬í„´ê°’ì€ ëª¨ë‘ ë„¤íŠ¸ì›Œí¬ë¡œ ì „ë‹¬ë˜ì–´ì•¼ í•˜ë©°, ì§ë ¬í™”ë¡œ í¬ì¥ë˜ê¸°ì—Â **ëª¨ë‘ ì§ë ¬í™”ê°€ ê°€ëŠ¥í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì´ë‹¤.**
- ë”°ë¼ì„œ ì§ì ‘ ë§Œë“  í˜•ì‹ì„ ì „ë‹¬í•œë‹¤ë©´, í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ ë•Œ Serializable ì¸í„°í˜ì´ìŠ¤ë„ êµ¬í˜„í•´ì•¼ í•œë‹¤.
> State í´ë˜ìŠ¤ë„ ì§ë ¬í™”í•  ìˆ˜ ìˆë„ë¡ ë°”ê¿”ì¤€ë‹¤.

```
import java.io.*; public interface State extends Serializable { ... }
```

```
public class NoQuarterState implements State {
    // Serializableì„ êµ¬í˜„í•˜ê¸° ìœ„í•´ ë°˜ë“œì‹œ serialVersionUID í•„ë“œê°€ í•„ìš”í•¨.
    private static final long serialVersionUID = 2L;
    // ì—­ì°¸ì¡°í•˜ëŠ” ë¶€ë¶„ì€ transient í‚¤ì›Œë“œë¥¼ ì¶”ê°€í•´ ì§ë ¬í™”í•˜ì§€ ì•Šë„ë¡ í•œë‹¤.
    transient GumballMachine gumballMachine;
}
```

ì°¸ê³  : JVMì—ì„œÂ `transient`Â í‚¤ì›Œë“œê°€ ì¶”ê°€ëœ í•„ë“œëŠ” ì§ë ¬í™”í•˜ì§€ ì•ŠëŠ”ë‹¤.

```java
transient GumballMachine gumballMachine;
```

#### 2ë‹¨ê³„ : ì„œë¹„ìŠ¤ êµ¬í˜„ í´ë˜ìŠ¤ ë§Œë“¤ê¸°


1. ì„œë¹„ìŠ¤ í´ë˜ìŠ¤ì—Â **ì›ê²© ì¸í„°í˜ì´ìŠ¤**ë¥¼ êµ¬í˜„

```java
import java.rmi.*;
import java.rmi.servre.*;

// UnicastRemoteObjectì˜ ì„œë¸Œí´ë˜ìŠ¤ì—¬ì•¼ ì›ê²© ì„œë¹„ìŠ¤ ì—­í• ì„ í•  ìˆ˜ ìˆë‹¤.
public class GumballMachine extends UnicastRemoteObject implements GumballMachineRemote {  
	// UnicastRemoteObjectëŠ” Serializableì„ êµ¬í˜„í•˜ë¯€ë¡œ serialVersionUID í•„ë“œê°€ í•„ìš”í•¨
    private static final long serialVersionUID = 2L;
    
    ...
    // `RemoteException`ì„ ì„ ì–¸í•˜ëŠ” ìƒì„±ì êµ¬í˜„
    public GumballMachine(String location, int numberGumballs) throws RemoteException {
    	...
    }
    
    ...
    
    public int getCount() { return count; }
    public State getState() { return state; }
    public String getLocation() { return location; }
}
```

3. ì„œë¹„ìŠ¤ë¥¼ RMI ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— ë“±ë¡
	- ì›ê²© ì„œë¹„ìŠ¤ë¥¼ ì›ê²© í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì“¸ ìˆ˜ ìˆê²Œ ë§Œë“œëŠ” ê³¼ì •ì´ë‹¤.
    - ì„œë¹„ìŠ¤ë¥¼ êµ¬í˜„í•œ ê°ì²´ë¥¼ ë“±ë¡í•˜ë©´ RMI ì‹œìŠ¤í…œì€ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— ìŠ¤í…ë§Œ ë“±ë¡í•œë‹¤. (í´ë¼ì´ì–¸íŠ¸ëŠ” ìŠ¤í…ë§Œ í•„ìš”í•˜ê¸° ë•Œë¬¸)
    - ì„œë¹„ìŠ¤ ë“±ë¡ :Â `java.rmi.Naming.rebind()`

```java
public class GumballMachineTestDrive {

    public static void main(String[] args) {
        GumballMachineRemote gumballMachine = null;
        int count;
        
        if (args.length < 2) {
            System.out.println("GumballMachine <name> <inventory>");
            System.exit(1);
        }
        
        try {
            count = Integer.parseInt(args[1]);
            
            gumballMachine = new GumballMachine(args[0], count);
            // GumballMachine ìŠ¤í…ì„ gumballmachine ì´ë¦„ìœ¼ë¡œ ë“±ë¡
            Naming.rebind("//" + args[0] + "/gumballmachine", gumballMachine);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
```

#### 3ë‹¨ê³„ : rmiregistry ì‹¤í–‰í•˜ê¸°
```bash
rmiregistry
java GumballMachineTestDrive austin.mightygumball.com 100
```

- í„°ë¯¸ë„ì„ í†µí•´ rmiregistryë¥¼ ì‹¤í–‰
- í´ë˜ìŠ¤ì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ë””ë ‰í† ë¦¬ì—ì„œ ì‹¤í–‰í•´ì•¼ í•œë‹¤.

ì´ì œ ë‹¤ìŒê³¼ ê°™ì´ ëª¨ë‹ˆí„°ë§ì´ ê°€ëŠ¥í•˜ë‹¤.
```java
import java.rmi.*;

public class GumballMonitorTestDrive {

    public static void main(String[] args) {
        String[] location = {"rmi://santafe.mightygumball.com/gumballmachine",
                              "rmi://boulder.mightygumball.com/gumballmachine",
                              "rmi://austin.mightygumball.com/gumballmachine"};
        
        GumballMonitor[] monitor = new GumballMonitor[location.length];
        
        for (int i = 0; i < location.length; i++) {
            try {
                GumballMachineRemote machine = (GumballMachineRemote) Maming.lookup(location[i]);
                monitor[i] = new GumballMonitor(machine);
                System.out.println(monitor[i]);
            } catch (Exception e) {
                e.printStackTrace();
            }
        }
        
        for (int i = 0; i < monitor.length; i++) {
            monitor[i].report();
        }
    }
}
```

#### ì‘ë™ ë°©ì‹
1. í´ë¼ì´ì–¸íŠ¸ëŠ” í”„ë¡ì‹œ ê°ì²´(Stub)ë¥¼ í†µí•´ ìš”ì²­ì„ ì „ë‹¬
2. í”„ë¡ì‹œëŠ” ë„¤íŠ¸ì›Œí¬ë¥¼ í†µí•´ ì›ê²© ì„œë²„ì— ìˆëŠ” ìŠ¤ì¼ˆë ˆí†¤(Skeleton)ì—ê²Œ ìš”ì²­
3. ìŠ¤ì¼ˆë ˆí†¤ì€ ì‹¤ì œ ê°ì²´ì˜ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ê³  ê²°ê³¼ë¥¼ ë‹¤ì‹œ í”„ë¡ì‹œì—ê²Œ ë°˜í™˜


ì°¸ê³  : ë°ì´í„° ì§ë ¬í™”ì™€ ì—­ì§ë ¬í™”
**ë°ì´í„° ì§ë ¬í™”**Â : ë©”ëª¨ë¦¬ë¥¼ ë””ìŠ¤í¬ì— ì €ì¥í•˜ê±°ë‚˜, ë„¤íŠ¸ì›Œí¬ í†µì‹ ì— ì‚¬ìš©í•˜ê¸° ìœ„í•œ í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ê²ƒ
**ë°ì´í„° ì—­ì§ë ¬í™”**Â : ë””ìŠ¤í¬ì— ì €ì¥í•œ ë°ì´í„°ë¥¼ ì½ê±°ë‚˜, ë„¤íŠ¸ì›Œí¬ í†µì‹ ìœ¼ë¡œ ë°›ì€ ë°ì´í„°ë¥¼ ë©”ëª¨ë¦¬ì— ì“¸ ìˆ˜ ìˆë„ë¡ ë³€í™˜í•˜ëŠ” ê²ƒ


**ì§ë ¬í™”ë¥¼ í•˜ëŠ” ì´ìœ **
ì§ë ¬í™”ë¥¼ í•˜ê²Œ ë˜ë©´ ê° ì£¼ì†Œ ê°’ì´ ê°€ì§€ëŠ” ë°ì´í„°ë¥¼ ì „ë¶€ ëŒì–´ ëª¨ì•„ì„œ ê°’ í˜•ì‹ ë°ì´í„°ë¡œ ë³€í™˜í•´ ì¤€ë‹¤.
ì§ë ¬í™”ê°€ ëœ ë°ì´í„°ëŠ” ì–¸ì–´ì— ë”°ë¼ì„œ í…ìŠ¤íŠ¸ ë˜ëŠ” ë°”ì´ë„ˆë¦¬ ë“±ì˜ í˜•íƒœê°€ ë˜ëŠ”ë°,   ì´ëŸ¬í•œ í˜•íƒœê°€ ë˜ì—ˆì„ ë•Œ ì €ì¥í•˜ê±°ë‚˜ í†µì‹ í•  ë•Œ íŒŒì‹±ì´ ê°€ëŠ¥í•œ ìœ ì˜ë¯¸í•œ ë°ì´í„°ê°€ ëœë‹¤.
ì¦‰, ì§ë ¬í™”ë¥¼ í•˜ëŠ” ì´ìœ ëŠ” ì‚¬ìš©í•˜ê³  ìˆëŠ” ë°ì´í„°ë¥¼ íŒŒì¼ ì €ì¥ í˜¹ì€ ë°ì´í„° í†µì‹ ì—ì„œ íŒŒì‹±í•  ìˆ˜ ìˆëŠ” ìœ ì˜ë¯¸í•œ ë°ì´í„°ë¥¼ ë§Œë“¤ê¸° ìœ„í•¨ì´ë‹¤.


---
## ê°€ìƒ í”„ë¡ì‹œ

> ğŸ’¡Â ìƒì„±í•˜ëŠ” ë° ë§ì€ ë¹„ìš©ì´ ë“œëŠ” ê°ì²´**ë¥¼ ëŒ€ì‹ í•œë‹¤.
- ì§„ì§œ ê°ì²´(RealSubject)ê°€ í•„ìš”í•œ ìƒí™©ì´ ì˜¤ê¸° ì „ê¹Œì§€ ê°ì²´ì˜ ìƒì„±ì„ ë¯¸ë£¨ëŠ” ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤.
- ê°ì²´ ìƒì„± ì „ì´ë‚˜ ê°ì²´ ìƒì„± ë„ì¤‘ì— ê°ì²´ë¥¼ ìˆ¨ê¸°ê¸° ìœ„í•˜ì—¬ ê·¸ë¥¼ ëŒ€ì‹ í•˜ê¸°ë„ í•œë‹¤.
- RealSubjectê°€ ìƒì„±ë˜ì–´ ìˆëŠ” ìƒíƒœì—ì„œëŠ” RealSubjectì— ë°”ë¡œ ìš”ì²­ì„ ì „ë‹¬í•œë‹¤.

### êµ¬í˜„ ì˜ˆì œ - ê°€ìƒ í”„ë¡ì‹œ


ì´ë¯¸ì§€ ë·°ì–´
1. ì£¼ì–´ì§„ URLë¡œë¶€í„° ì´ë¯¸ì§€ë¥¼ ë¡œë”©
2. **ì´ë¯¸ì§€ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë™ì•ˆ**Â í™”ë©´ì— ë©”ì‹œì§€(â€Loading album cover, please wait...â€)ë¥¼ ë³´ì—¬ì£¼ê¸°
    _â†’ ê°€ìƒ í”„ë¡ì‹œê°€ í•´ì•¼í•  ì¼_
3. ì´ë¯¸ì§€ ë¡œë”©ì´ ëë‚˜ë©´ í™”ë©´ì— ì´ë¯¸ì§€ ë„ìš°ê¸°

ì—¬ê¸°ì„œëŠ” í”„ë¡ì‹œëŠ”Â `ìƒì„±í•˜ëŠ” ë° ë§ì€ ë¹„ìš©ì´ ë“œëŠ” ê°ì²´ë¥¼ ìˆ¨ê¸°ëŠ” ìš©ë„`ë¡œ ì“°ì¸ë‹¤.  
(ë°ì´í„°ë¥¼ ë„¤íŠ¸ì›Œí¬ë¡œ ê°€ì ¸ì™€ì•¼ í•˜ê¸° ë•Œë¬¸ì— ì‹œê°„ì´ ë§ì´ ì†Œìš”ë¨)

ì•„ë˜ ì½”ë“œì—ì„œÂ `paintIcon`Â í•¨ìˆ˜ë¥¼ ì£¼ì˜ ê¹Šê²Œ ë³´ì.

```java
class ImageProxy implements Icon {

    volatile ImageIcon imageIcon;
    final URL imageURL;
    Thread retrievalThread;
    boolean retrieving = false;

    public ImageProxy(URL url) {
        imageURL = url; // ì´ë¯¸ì§€ ë¡œë”©ì´ ëë‚˜ë©´ ì´ URLì— ìˆëŠ” ì´ë¯¸ì§€ë¥¼ í™”ë©´ì— í‘œì‹œ
    }

    // ì¤‘ëµ

    synchronized void setImageIcon(ImageIcon imageIcon) {
        this.imageIcon = imageIcon;
    }

    // ì´ë¯¸ì§€ ì¶œë ¥
    public void paintIcon(final Component c, Graphics g, int x, int y) {
        // (1) ì´ë¯¸ì§€ê°€ ì™„ì „íˆ ìƒì„±ë˜ì—ˆì„ ê²½ìš°
        if (imageIcon != null) {
            imageIcon.paintIcon(c, g, x, y);
        }
        // (2) ì´ë¯¸ì§€ê°€ ì•„ì§ ì™„ì „íˆ ìƒì„±ë˜ì§€ ì•Šì•˜ì„ ê²½ìš°
        else {
            g.drawString("Loading album cover, please wait...", x + 300, y + 190);

            // ì´ë¯¸ì§€ë¥¼ ê°€ì ¸ì˜¤ê³  ìˆëŠ” ì¤‘ì´ ì•„ë‹ˆë¼ë©´
            if (!retrieving) {
                retrieving = true;
                retrievalThread = new Thread(() -> {
                    try {
                        setImageIcon(new ImageIcon(imageURL, "Album Cover"));
                        c.repaint(); // í™”ë©´ ê°±ì‹ 
                    } catch (Exception e) {
                        e.printStackTrace();
                    }
                });
                retrievalThread.start();
            }
        }
    }

}
```


[![á„€á…¡á„‰á…¡á†¼ á„‘á…³á„…á…©á†¨á„‰á…µ](https://user-images.githubusercontent.com/86337233/212689081-3c2fc3fd-2f44-4182-be79-547568408c1e.png)](https://user-images.githubusercontent.com/86337233/212689081-3c2fc3fd-2f44-4182-be79-547568408c1e.png)  

#### ë°ì½”ë ˆì´í„° íŒ¨í„´ vs. ê°€ìƒ í”„ë¡ì‹œ

- `ë°ì½”ë ˆì´í„° íŒ¨í„´`Â : í´ë˜ìŠ¤ì— ìƒˆë¡œìš´ í–‰ë™ì„ ì¶”ê°€í•˜ëŠ” ìš©ë„ë¡œ ì‚¬ìš©
- `í”„ë¡ì‹œ`Â : ì–´ë–¤ í´ë˜ìŠ¤ë¡œì˜ ì ‘ê·¼ì„ ì œì–´í•˜ëŠ” ìš©ë„ë¡œ ì‚¬ìš©


ìœ„ ì˜ˆì‹œì—ì„œ ì´ë¯¸ì§€ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë™ì•ˆ ë¡œë”© ë©”ì‹œì§€ë¥¼ í‘œì‹œí•˜ë„ë¡ â€œí–‰ë™ì„ ì¶”ê°€â€í•œ ê²ƒìœ¼ë¡œ ë³¼ ìˆ˜ ìˆì§€ë§Œ,  
`ImageProxy`ëŠ”Â **í´ë¼ì´ì–¸íŠ¸ì™€**Â `ImageIcon`**ì„ ë¶„ë¦¬í•˜ì—¬**Â `ImageIcon`ë¡œì˜ ì ‘ê·¼ì„ ì œì–´í•˜ê³  ìˆëŠ” ê²ƒì´ë‹¤.

ë§Œì•½ í´ë¼ì´ì–¸íŠ¸ì™€Â `ImageIcon`ì´ ê²°í•©ë˜ì–´ ìˆì—ˆë‹¤ë©´  
ì´ë¯¸ì§€ê°€ ì™„ì „íˆ ë¡œë”©ë˜ê¸° ì „(`ImageIcon`Â ê°ì²´ ìƒì„±ì´ ì™„ë£Œë˜ê¸° ì „)ê¹Œì§€ëŠ” ì¸í„°í˜ì´ìŠ¤ë¥¼ í™”ë©´ì— í‘œì‹œí•  ìˆ˜ ì—†ë‹¤.

ì´ì²˜ëŸ¼ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì§„ì§œ ê°ì²´ê°€ ì•„ë‹Œ í”„ë¡ì‹œë¥¼ ì‚¬ìš©í•˜ë„ë¡ ë§Œë“œëŠ” ë°©ë²•ë“¤ ì¤‘Â `íŒ©í† ë¦¬`ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ê°€ì¥ í”íˆ ì“°ì´ëŠ” ê¸°ë²•ì´ë‹¤.

íŒ©í† ë¦¬ì—ì„œÂ ì§„ì§œ ê°ì²´ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•´ì„œ ë¦¬í„´í•˜ë©´ ëœë‹¤.

  
  

## ë³´í˜¸ í”„ë¡ì‹œ

> ğŸ’¡Â **ì ‘ê·¼ ê¶Œí•œì„ ë°”íƒ•ìœ¼ë¡œ**Â ê°ì²´ë¡œì˜ ì ‘ê·¼ì„ ì œì–´í•˜ëŠ” í”„ë¡ì‹œ

### êµ¬í˜„ ì˜ˆì œ - ë³´í˜¸ í”„ë¡ì‹œ

ë°ì´íŒ… ì„œë¹„ìŠ¤ë¥¼ êµ¬í˜„í•´ë³¸ë‹¤ê³  í•˜ì.

ì´ ì„œë¹„ìŠ¤ì—ì„œì˜ ìš”êµ¬ì‚¬í•­ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

1. ê³ ê°ì´ ìê¸° ì •ë³´ë¥¼ ì§ì ‘ ìˆ˜ì •í•  ìˆ˜ ìˆë„ë¡ í•˜ë©´ì„œ,Â **ë‹¤ë¥¸ ê³ ê°ì€ ê·¸ ì •ë³´ë¥¼ ìˆ˜ì •í•  ìˆ˜ ì—†ë„ë¡**Â í•´ì•¼ í•œë‹¤.
2. ì„ í˜¸ë„ëŠ” ë°˜ëŒ€ë¡œ, ë‹¤ë¥¸ ê³ ê°ë§Œ ì ìˆ˜ë¥¼ ë§¤ê¸¸ ìˆ˜ ìˆê³ Â **ìì‹ ì€ ì ìˆ˜ë¥¼ ë§¤ê¸¸ ìˆ˜ ì—†ë„ë¡**Â í•´ì•¼ í•œë‹¤.


ì´ë“¤ì„ í•´ê²°í•˜ê¸° ìœ„í•´ì„œëŠ” 2ê°œì˜ í”„ë¡ì‹œê°€ í•„ìš”í•˜ë‹¤.

- ë³¸ì¸ì˜Â `Person`Â ê°ì²´ì— ì ‘ê·¼í•˜ëŠ” í”„ë¡ì‹œ
- ë‹¤ë¥¸ ì‚¬ëŒë“¤ì˜Â `Person`Â ê°ì²´ì— ì ‘ê·¼í•˜ëŠ” í”„ë¡ì‹œ


`Person`Â ê°ì²´ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

```java
public interface Person {

    String getName();

    String getGender();

    String getInterests();

    int getGeekRating();

    void setName(String name);

    void setGender(String gender);

    void setInterests(String interests);

    void setGeekRating(int rating);

}
```

  
ìœ„ì—ì„œ ì‚´í´ë³´ì•˜ë˜ ë™ì  í”„ë¡ì‹œ ê¸°ìˆ ì„ ì‚¬ìš©í•˜ì—¬ ë™ì  í”„ë¡ì‹œë¥¼ êµ¬í˜„í•´ë³´ì.

  

[![ë™ì  á„‘á…³á„…á…©á†¨á„‰á…µ](https://user-images.githubusercontent.com/86337233/212689085-cd285023-fb6d-4650-88f7-c56207a5bd91.png)](https://user-images.githubusercontent.com/86337233/212689085-cd285023-fb6d-4650-88f7-c56207a5bd91.png)  

1. 2ê°œì˜Â `InvocationHandler`Â ìƒì„±
2. ë™ì  í”„ë¡ì‹œ ìƒì„± ì½”ë“œ ë§Œë“¤ê¸°
3. ì ì ˆí•œ í”„ë¡ì‹œë¡œÂ `Person`Â ê°ì²´ ê°ì‹¸ê¸°
    - ê³ ê° ìì‹ ì˜ ê°ì²´ â†’ owner
    - ë‹¤ë¥¸ ê³ ê°ì˜ ê°ì²´ â†’ non-owner
    
    [![Person á„€á…¢á†¨á„á…¦ - á„‘á…³á„…á…©á†¨á„‰á…µ](https://user-images.githubusercontent.com/86337233/212689087-1575a91e-0325-47e8-83b3-ac9f59633e77.png)](https://user-images.githubusercontent.com/86337233/212689087-1575a91e-0325-47e8-83b3-ac9f59633e77.png)
    

#### 1ë‹¨ê³„ : InvocationHandler ìƒì„±

í”„ë¡ì‹œì˜ ë©”ì„œë“œê°€ í˜¸ì¶œë˜ë©´ í”„ë¡ì‹œëŠ” ê·¸ í˜¸ì¶œì„Â `InvocationHandler`(í˜¸ì¶œ í•¸ë“¤ëŸ¬)ì—ê²Œ ë„˜ê¸°ëŠ”ë°,  
ì—¬ê¸°ì—ëŠ” ë©”ì„œë“œê°€Â `invoke()`Â í•˜ë‚˜ë°–ì— ì—†ë‹¤.

ì¦‰, í”„ë¡ì‹œì˜ ì–´ë–¤ ë©”ì„œë“œê°€ í˜¸ì¶œë˜ë“  ë¬´ì¡°ê±´Â `invoke()`Â ë©”ì„œë“œê°€ í˜¸ì¶œë˜ëŠ” ê²ƒì´ë©°,  
ê·¸ ë©”ì„œë“œ ì†ì—ì„œ ì£¼ì–´ì§„ ìš”ì²­ì„ ì–´ë–»ê²Œ ì²˜ë¦¬í• ì§€ë¥¼ ê²°ì •í•œë‹¤.

```java
return method.invoke(person,args);
// method : invoke() ë©”ì„œë“œ í˜¸ì¶œë¡œ ì „ë‹¬ëœ ê°ì²´
// person : ì§„ì§œ ê°ì²´ì— ë©”ì„œë“œë¥¼ í˜¸ì¶œ
// args : ì²˜ìŒì— ë°›ì•˜ë˜ ì¸ìë“¤ì„ ì „ë‹¬
```

##### ë³¸ì¸ìš© í”„ë¡ì‹œë¥¼ ìœ„í•œ í˜¸ì¶œ í•¸ë“¤ëŸ¬ : OwnerInvocationHandler


```java
import java.lang.reflect.InvocationHandler;
import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;

public class OwnerInvocationHandler implements InvocationHandler {

    Person person;

    public OwnerInvocationHandler(Person person) {
        this.person = person;
    }

    @Override
    public Object invoke(Object proxy, Method method, Object[] args) throws IllegalAccessException {
        try {
            if (method.getName().startsWith("get")) {
                return method.invoke(person, args);
            } else if (method.getName().equals("setGeekRating")) {
                throw new IllegalAccessException(); // ë©”ì„œë“œ í˜¸ì¶œì„ ë§‰ìŒ
            } else if (method.getName().startsWith("set")) {
                return method.invoke(person, args);
            }
            // ë‚˜ë¨¸ì§€ ë©”ì„œë“œëŠ” ëª¨ë‘ í—ˆìš© â†’ ì£¼ì œì— ìˆëŠ” ë©”ì„œë“œë¥¼ í˜¸ì¶œ
        }
        // ì§„ì§œ ì£¼ì œì—ì„œ ì˜ˆì™¸ë¥¼ ë˜ì¡Œì„ ê²½ìš°
        catch (InvocationTargetException e) {
            e.printStackTrace();
        }
        // ë‹¤ë¥¸ ë©”ì„œë“œê°€ í˜¸ì¶œë˜ì—ˆì„ ê²½ìš°
        return null;
    }

}
```

##### íƒ€ì¸ìš© í”„ë¡ì‹œë¥¼ ìœ„í•œ í˜¸ì¶œ í•¸ë“¤ëŸ¬ : NonOwnerInvocationHandler

```java
import java.lang.reflect.InvocationHandler;
import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;

public class NonOwnerInvocationHandler implements InvocationHandler {

    Person person;

    public NonOwnerInvocationHandler(Person person) {
        this.person = person;
    }

    @Override
    public Object invoke(Object proxy, Method method, Object[] args) throws IllegalAccessException {
        try {
            if (method.getName().startsWith("get")) {
                return method.invoke(person, args);
            } else if (method.getName().equals("setGeekRating")) {
                return method.invoke(person, args);
            } else if (method.getName().startsWith("set")) {
                throw new IllegalAccessException(); // ë©”ì„œë“œ í˜¸ì¶œì„ ë§‰ìŒ
            }
            // ë‚˜ë¨¸ì§€ ë©”ì„œë“œëŠ” ëª¨ë‘ í—ˆìš© â†’ ì£¼ì œì— ìˆëŠ” ë©”ì„œë“œë¥¼ í˜¸ì¶œ
        }
        // ì§„ì§œ ì£¼ì œì—ì„œ ì˜ˆì™¸ë¥¼ ë˜ì¡Œì„ ê²½ìš°
        catch (InvocationTargetException e) {
            e.printStackTrace();
        }
        // ë‹¤ë¥¸ ë©”ì„œë“œê°€ í˜¸ì¶œë˜ì—ˆì„ ê²½ìš°
        return null;
    }

}
```

#### 2ë‹¨ê³„ : ë™ì  í”„ë¡ì‹œ ìƒì„± ì½”ë“œ ë§Œë“¤ê¸°

```java
/**
 * TODO: ë™ì  í”„ë¡ì‹œ ìƒì„± ì½”ë“œ
 *
 * @param person Person ê°ì²´(ì§„ì§œ ì£¼ì œ)
 * @return í”„ë¡ì‹œ
 * (í”„ë¡ì‹œì˜ ì¸í„°í˜ì´ìŠ¤ == ì£¼ì œì˜ ì¸í„°í˜ì´ìŠ¤)
 */
    Person getOwnerProxy(Person person) {
            return (Person) Proxy.newProxyInstance(
            person.getClass().getClassLoader(), // personì˜ í´ë˜ìŠ¤ ë¡œë”
            person.getClass().getInterfaces(), // í”„ë¡ì‹œì—ì„œ êµ¬í˜„í•´ì•¼ í•˜ëŠ” ì¸í„°í˜ì´ìŠ¤
            new OwnerInvocationHandler(person)); // í˜¸ì¶œ í•¸ë“¤ëŸ¬
    }

    Person getNonOwnerProxy(Person person) {
            return (Person) Proxy.newProxyInstance(
            person.getClass().getClassLoader(),
            person.getClass().getInterfaces(),
            new NonOwnerInvocationHandler(person));
    }
```


> `InvocationHandler`Â ìì²´ëŠ” í”„ë¡ì‹œê°€ ì•„ë‹ˆë¼,Â **ë©”ì„œë“œ í˜¸ì¶œì„ ì²˜ë¦¬í•˜ëŠ” í´ë˜ìŠ¤ì¼ ë¿**ì´ë‹¤.  
> ì‹¤ì œ í”„ë¡ì‹œëŠ”Â `Proxy.newProxyInstance()`Â ì •ì  ë©”ì„œë“œì— ì˜í•´ì„œ ì‹¤í–‰ ì¤‘ì— ë™ì ìœ¼ë¡œ ìƒì„±ëœë‹¤.


`newProxyInstance()`ë¥¼ í˜¸ì¶œí•  ë•Œì˜ í˜•ì‹ì—ëŠ” ëª‡ê°€ì§€ ì œí•œì´ ì¡´ì¬í•œë‹¤.

- ì¸í„°í˜ì´ìŠ¤ì˜ ë°°ì—´ì„ ì¸ìë¡œ ì „ë‹¬í•´ì•¼ í•œë‹¤.
- `public`ìœ¼ë¡œ ì§€ì •ë˜ì§€ ì•Šì€ ì¸í„°í˜ì´ìŠ¤ëŠ” ê°™ì€ íŒ¨í‚¤ì§€ì— ë“¤ì–´ìˆëŠ” ì¸í„°í˜ì´ìŠ¤ë§Œ ì¸ìë¡œ ì „ë‹¬í•  ìˆ˜ ìˆë‹¤.

ë” ìì„¸í•œ ì‚¬í•­ë“¤ì€Â [í•´ë‹¹ ë§í¬](https://docs.oracle.com/javase/7/docs/api/java/lang/reflect/Proxy.html)ë¥¼ ì°¸ê³ í•˜ê¸¸ ë°”ë€ë‹¤.

  

#### 3ë‹¨ê³„ : ì ì ˆí•œ í”„ë¡ì‹œë¡œ Person ê°ì²´ ê°ì‹¸ê¸°

ì „ì²´ ì½”ë“œ
##### ë³¸ì¸ìš© í”„ë¡ì‹œ ìƒì„± í›„ í…ŒìŠ¤íŠ¸

```java
// 1-1. ì¸ë¬¼ ì •ë³´ë¥¼ DBë¡œë¶€í„° ê°€ì ¸ì˜´
Person joe=getPersonFromDatabase("Joe Javabean");

// 1-2. ë³¸ì¸ìš© í”„ë¡ì‹œ ìƒì„±
Person ownerProxy = getOwnerProxy(joe);
System.out.println("Name is " + ownerProxy.getName());
ownerProxy.setInterests("bowling, Go");
System.out.println("Interests set from owner proxy");

// 1-3. ì„ í˜¸ë„ ì„¤ì • ì‹œë„ (ë³¸ì¸ìš© í”„ë¡ì‹œì—ì„œëŠ” ë¶ˆê°€)
try {
    ownerProxy.setGeekRating(10);
} catch (Exception e) {
    System.out.println("Can't set rating from owner proxy");
}
System.out.println("Rating is " + ownerProxy.getGeekRating());
```

ì¶œë ¥ ê²°ê³¼
```
Name is Joe Javabean
Interests set from owner proxy
Can't set rating from owner proxy
Rating is 7
```


##### íƒ€ì¸ìš© í”„ë¡ì‹œ ìƒì„± í›„ í…ŒìŠ¤íŠ¸

```java
// 2-1. íƒ€ì¸ìš© í”„ë¡ì‹œ ìƒì„±
Person nonOwnerProxy = getNonOwnerProxy(joe);
System.out.println("Name is " + nonOwnerProxy.getName());

// 2-2. ê´€ì‹¬ì‚¬ ë³€ê²½ ì‹œë„ (íƒ€ì¸ìš© í”„ë¡ì‹œì—ì„œëŠ” ë¶ˆê°€)
try {
    nonOwnerProxy.setInterests("bowling, Go");
} catch (Exception e) {
    System.out.println("Can't set interests from non owner proxy");
}

// 2-3. ì„ í˜¸ë„ ì„¤ì •
nonOwnerProxy.setGeekRating(3);
System.out.println("Rating set from non owner proxy");
System.out.println("Rating is " + nonOwnerProxy.getGeekRating());
```



ì¶œë ¥ ê²°ê³¼

```
Name is Joe Javabean
Can't set interests from non owner proxy
Rating set from non owner proxy
Rating is 5
```


https://aeliketodo.tistory.com/132
https://github.com/IT-Book-Organization/HeadFirst-DesignPattern/tree/main/Chapter_11