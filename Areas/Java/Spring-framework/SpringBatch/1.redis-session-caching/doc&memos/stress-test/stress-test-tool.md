# 사용 목적

레디스 세션 저장소 이용을 통해, 트래픽이 얼마나 절약되는 지 확인하기 위함.
나중에 다른 정보들도 캐싱을 이용하여 보여주는 것도 생각중...


# 툴 선정

https://baeji-develop.tistory.com/118

해당 포스트를 참조하였다.

## 고려대상

jmeter, k6, ngrinder, locust

jvm을 사용하는 언어의 경우, 무겁기 때문에 사용하기 어려움.
로컬에서 사용한다. 둘 다 사용하기 때문에 정확하게 판단이 되지 않을 가능성이 높다.

고려해야 할 도구는 k6와 locust로 좁혀졌다.
메모리의 경우 둘 다 jvm보다 낮기 때문에 중요도가 더 낮다고 여김.
애초에 많은 요청을 생성할 수 없기 때문에...
언어 학습 곡선이 낮고 환경 세팅이 간편한 RPS가 더 낮은 locust를 사용하기로 결정.


# 부하 테스트

캐싱 안한 것이 높게 나왔다.
스프링 시큐리티의 경우, 세션 저장소는 In-memory(톰캣 세션)를 사용했다. Redis와 동일하다.

레디스의 속도가 빠를 것이라고 예상했으나, 시큐리티 컨텍스트를 가져오는 작업, 즉 기존 세션의 정보를 가져오는 작업에서 트래픽이 발생할 것이라고 판단함.
이유는... 레디스가 키-값 DB이기 때문에, 탐색 시 더 효율적인 알고리즘을 사용하거나 별개 스레드를 이용하기 때문에 더 빠를 것이라 생각하였음.

흥미롭게도, 세션을 유지할 때에도 성능 향상이 존재했지만 첫 로그인 시에도 성능이 차이났었음.

Redis 없이 시도하였을 땐 CPU 점유율이 90%를 넘어간다는 위험문구도 떴었다.

그에 반해 Redis 사용 시에는 매우 안정적이고 낮은 Response Time을 제공했다. p95를 기준으로 최고 응답 시간이 약 8배 가량 차이났다.