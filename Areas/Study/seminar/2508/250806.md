대규모 트래픽 제어

기업에서 대규모 트래픽 제어를 어떻게 할까?

넷플릭스
MSA 기술
- SRP랑 연관지어서 생각하면 되는데... 실제로도 기반한 아이디어일까?
- 서비스의 기능 자체가 거대해지기 때문에 하나하나의 기능을 서비스로 운영함.

Istio
쿠버네티스 위에서 서비스 메시를 구현하는 오픈소스 플랫폼

오케스트레이션?
스케일링 등...

서비스 메시는 마이크로서비스들을 자동으로 관리해주는 플랫폼?

CDN?
content delivery network
각 로컬 서버가 내용을 대신 전달해줌.
각 로컬에 컨텐츠를 분산 저장한다?

카카오
API 트래픽 보호 전략
API gatewaty + rate limiting

Spring Cloud Gateway
인증 필터가 실행돼 유효한 토큰 확인 후 API로 전달
Security와의 차이점? 인증 및 보안 처리에 대한 스펙
여기는 Gateway에 대한 스펙임

Redis cache
메인 메모리에서 사본 만들고 빠르게 날리기
Redis에서 로그인 시 사용자 정보를 가져와 DB 접근 없이 빠르게 응답을 제공함.
- 메인 서버로의 부하를 분산시킨다.

key-value 및 해시 트리를 이용한 빠른 접근(부수적인 속도 향상 기능)
Redis 특) In-Memory InnoDB 형태로 저장되서 더 빠르다.
미친 상남자인데?
다운되면 죽으니까 특수한 처리하지 않으면 날아간다.


Kafka
apache kafka
분산형 이벤트 스트리밍 플랫폼

데이터 파이프라인 역할
큐형태의 시스템
요청을 큐에 넣어 비동기 처리해준다.

- 근데 왜 카프카임? (모름)

레디스 캐싱
조회가 많은 데이터를 미리 저장


kubernates HPA 기능
pod? 쿠버네티스 가장 작은 배포 단위
HPA를 이용해 pod를 오토스케일링한다.


프로메테우스&그라파나
프로메테우스?
오픈소스 모니터링 및 경고 플랫폼

그라파나?
데이터 시각화 도구

MSA 환경에서 메시징 큐가 필요한 이유?
각 서비스 간 데이터 통신을 위해 존재한다.

topic 단위로 발행?
발행 단위가 있고, 컨슈머는 본인이 받을 토픽을 정한다.
컨슈머가 그걸 가져가서 각 서버에 분배시켜준다?
이렇게 되면 던져놓고 다른 작업할 수 있게 됨. -> 비동기
쿠버네티스랑도 연결된다.
동기화를 위해 큐를 씀.
천둥번개쳐서 제주도 서버 날아감 -> 서울 서버로 페일오버라던지...

논리적으로 동일한 서비스, 물리적으로 분리된 서버. 어떻게 처리?
이 간극을 빠르고 정확하게 동기화하기 위해 메시징큐를 사용함.
데이터 이관 과정에서도, 사용자간 통신에서도 사용될 수도 있고... 다양한 메시징큐가 이렇게 사용됨.

MSA 아키텍처라고 하면
게이트웨이 앞단, 컨테이너 통신할수 있는 곳에서 위치할 수 있을듯.

gpt에 질문 던져놓으면 시간 오래걸림
던지고 백단은 자기일, 메시징큐가 그거 받아서 대답을 백단에 전달
서버 바깥에도 메시징큐를 위치시킬 수도 있다.

그라파나&프로메테우스?
cpu 로드율 80% 넘으면 슬랙으로 알람가게 설정할 수도 이음.
터지기 전에 대응하도록 모니터링..
구글 애널리틱스도 있다. 트래픽 기반으로 통계내는 데이터 시각화 도구도 있음.