암호화 기법?

암호화
평문을 암호문으로 변환하는 것

복호화
암호문을 평문으로 복원하는 것

# 2.1. 대칭 키 / 비대칭 키 알고리즘

## 대칭 키 알고리즘
대칭 키 (암호) 알고리즘
DES, 3DES, AES, ARIA, SEED, LEA 등이 있음.

전문가들의 의견에 따르면 최소 128비트 이상의 암호화 강도가 권장된다고 함.

DES(64비트), 3DES(112비트) 등의 알고리즘은 권장되지 않음.

des 생략하고 암호 강도

| 대칭 키 알고리즘 | 암호 강도 (비트)  |
| --------- | ----------- |
| AES       | 128/192/256 |
| ARIA      | 128/192/256 |
| SEED      | 128/256     |
| LEA       | 128/192/256 |

68-70p 자바 예제

블록 암호화 방식에는 운용 모드가 존재함.
ECB(electronic code book), CBC(cipher-block chaining) 등이 있다.
ECB 사용 시 데이터를 블록으로 나눈 후 각각 암호화한다.
CBC는 데이터를 블록으로 나누고 블록 간 체인으로 만들어 암호화한다.
이전 블록 암호화 결과를 다음 블록의 암호화에서 사용하기 때문에,  ECB보다 강력한 보안을 제공한다.

ECB, CBC, CFB, OFB, CTR 등이 있다.

패딩 하는 것에도 방식이 존재한다. (허거덩)
블록 암호화 방식을 사용하므로 각 블록의 길이는 일정해야 한다.
주로 사용하는 방식은 PKCS#5와 PKCS#7이 있다.
\#5의 경우 패딩 값을 최대 8바이트 까지만 채우지만 \#7은 최대 255바이트까지 채운다. 요즘 사용하는 대부분의 대칭키 암호 알고리즘은 블록 크기가 16바이트 이상이기에 \#7을 주로 사용한다.

암호문을 Base64로 인코딩하는 과정이 있다.
그 이유에 대한 설명이 있는데,
암호문은 이진 데이터로 생성된다.
이진 데이터는 네트워크 통신 과정에서 신호 왜곡, 비트 오류 등의 이유로 손실 위험이 있고 DB 관점에서 이진 데이터보다 문자열 데이터가 처리하기 용이하다.
또한 다른 애플리케이션과 연동하거나 데이터 입출력 시 Base64로 표현하는 규약이 존재하기 때문.

다음으로 복호화 방식에 대해 설명한다.
Base 64 디코딩, decrypt 모드로 설정한 알고리즘으로 돌려주면 복호화가 끝난다.

## 비대칭 키 알고리즘

두 개의 키를 가진다.

공개 키
암호화에 사용하는 키

개인 키(비밀 키)
복호화에 사용하는 키

둘 다 한 쌍이라 같은 쌍으로 사용해야 함.

> 책에 나오지 않은 부연설명
> 특정 수확적 원리에 기반한 복잡한 연산을 수행하기 때문에, 속도가 느리고 처리량이 적다.
> 키 교환의 어려움이 없는 장점을 제공해 암호화된 메시지를 개인 키로만 복호화할 수 있게 함으로써 안전한 데이터 전송과 디지털 서명이 가능하게 된다...?
> RSA의 경우 큰 소수 곱셈이나 이산 로그 문제
> ECC는 타원 곡선 문제
> 미적분 관련한 문제를 알고리즘으로 하는 것도 있다고 알고 있다.

대칭 / 비대칭 비교
대칭이 비대칭보다 상대적으로 빠르다. 많이 빠르다...
비대칭의 경우, 개인 키가 노출되지 않으므로 전송 과정에서 위험이 줄어든다.

반대로! 비밀 키로 암호화하고 공개키로 복호화하는 것도 존재한다.
공동 인증서 같은 전자 서명에서 사용된다.

책에서는 RSA 알고리즘으로 대칭 알고리즘과 비교한다.
키 길이는 2048/4096 비트
전자서명, 키 교환, 인증 등에서 사용된다고 한다.


# 2.2 단방향 암호화, 해시 함수

단방향 암호화는 한 쪽으로만 암호화하는 기법이다.
그말인 즉슨, 암호화를 하면 복호화가 불완전하다는 뜻이다.
(불가능한 건 아니지만 물리적인 시간, 하드웨어 리소스 등의 비용이 굉장히 많이 들어가 비효율적이며 억지 기법을 사용해야 함. 그래서 책에서는 불가능하다고 표현한다.)

### 특성
비밀번호 암호화, 문서 진위 여부 검증 등 다양한 곳에서 사용한다.
주로 훼손되거나 노출되면 안되는 원본 데이터를 난해하게 만들어 제3자에게 노출되어도 안전하도록 하는 용도로 사용함.
갖고 있는 문서와 해시 암호화된 문서를 비교하여 무결성을 검사하는 식으로 이용한다.

- 항상 고정 길이의 값 출력
- 동일한 입력값에 대해 항상 동일한 해시 값 출력
- 눈사태 효과(avalanche effect, 영어로 하면 조금 더 멋져보임)
  조금의 변화가 결과의 큰 변화를 야기함.
- 복호화 불가 및 눈사태 효과로 인한 입력값 유추 불가능


### 안전한 해시 알고리즘
sha는 -1, -256과 같이 숫자가 붙는다.
Secure Hash Standard라고 하며 256 이상인 해시 알고리즘 사용이 권고됨.
해시 길이가 짧은 것의 단점
수많은 입력이 들어오는 데, 길이가 작을 경우 그만큼 결과가 한정됨 -> 해시 충돌 시 위험해진다.

### 솔트값

해커들은 잘 알려진 비밀번호와 이에 대한 해시값을 미리 데이터베이스로 구축해놓는다. 이렇게 비밀번호와 해시값이 저장된 DB를 레인보우 테이블이라고 부른다. 안전하게 해시 값으로 저장하더라도 비밀번호가 유추 가능한 것이다...! 이런 해커들의 공격에 대응하기 위해 솔트라는 임의 길이 고정 난수 값을 사용한다.
비밀번호에 솔트값을 추가해 결과가 완전히 달라지니 유추가 어려워진다.

## 2.3 개인정보를 지킬 수 있는 암호화

### 알고리즘을 이용한 개인정보 암호화

대칭 키 또는 비대칭 키 암호 알고리즘을 이용해 코드를 작성하면 된다.

mariadb의 경우, AES_ENCRYPT()라는 암호화 함수를 제공한다. (이 외에도 더 있을 것임...)

추가로 조사하니, 주민등록번호와 같은 고유 식별정보는 해시가 아니라 복호화 가능한 양방향 암호화 방식을 사용해야 한다고 함.
물론 비밀번호는 해시다.

### HTTPS를 이용한 통신 구간 암호화

https를 이용해 ssl/tls 암호화를 하여 통신 구간을 암호화할 수 있다.
그리고 필수이다.
와이어샤크를 이용해 네트워크 상에서 클라이언트와 서버 간의 패킷을 볼 수 있다.

ssl/tls 방식은 인증서 방식을 사용하는데, 신뢰받지 않은 인증서를 사용 시 브라우저 등에서 경고메시지가 뜬다! OpenSSL 같은 것은 개발환경에서만 사용하자.
https를 사용하는 경우, 이제는 SSL이 아니라 TLS를 사용해야 한다. 취약점이 다수 발견되었기 때문.


## 2.4 안전한 코딩 기법

시큐어 코딩에 대한 이야기이다.
코드 단위에서 보안 취약점을 방어하는 코딩 기법에 대한 것임.

OWASP Top 10이라고 하면 기억이 날 것이다.
이건 보안 관련이 아니더라도 국룰수준으로 알고있어야 한다고 함...
매년 갱신된다. (매년? 일단 특정 때마다 top 10 바귐)

sql 인젝션, os 명령어 인젝션, XSS 등이있음

크로스 사이트 스크립팅 XSS
반사와 저장으로 나뉨
반사는 URL 매개변수에 스크립트 삽입, 저장은 DB에 저장되는 방법

요즘은 이런거 잘 대응 가능해서 사용가능한 태그만  필터링하는 방법 같은게 잘 되어있다.

## 2.5 클라우드 보안

기존 온프레미스 환경은 이것저것 세팅해야 하는 것이 많다.
클라우드 서비스(이것도 이제 꽤 됐지 않았을까...?)는 버튼 딸깍이면 운영체제부터 WAS, DBMS 플랫폼이 완성!

클라우드 컴퓨팅은 서버, 스토리지, 네트워크 등을 풀(Pool) 형태로 인터넷을 통해 제공하는 기술임. 이 기술을 이용해 자원을 서비스 형태로 제공하는 것을 클라우드 서비스라고 함.
컴퓨팅 자원을 사용자에게 빌려주는 일종의 렌탈 서비스
빌려주는 자원에 따라 서비스 유형이 달라짐.

애플리케이션은 SaaS
플랫폼은 PaaS
인프라는 IaaS

AWS, Azure(얘 왜 애저임 아주르아님?), 네이버 클라우드, KT 클라우드 등이 제공자다.

사업자가 책임지는 영역과 사용자가 책임지는 영역을 분리하기 때문에 알아서 다 해주는 게 아니다...
'공유 책임 모델'이라는 게 있다.
사업자와 고객이 자원에 대한 책임을 공유한다는 내용을 골자로 하며, 서로 책임져야 할 보안이 나뉘어져 있다!
각 사업체 별로 다른 것으로 보임. 으악!

### 다양한 보안 서비스 세계
클라우드 서비스 이용시 방화벽, 웹 방화벽, 침입 방지 시스템(IPS) 등 다양한 보안 서비스를 이용하게 된다.
AWS EC2의 경우, security group이라는 방화벽 서비스가 기본으로 제공된다. 인바운드-아웃바운드 규칙 설정이 가능하다.

웹 서비스 보안을 위한 웹 방화벽이라는 서비스도 필수라고 함.
sql 인젝션, XSS 등의 주요 취약점 탐지 및 차단, 직접 필터 설정을 통한 특정 공격 패킷 차단 등 상식적으로 알아야 하는? 보안 서비스라고 한다?

IPS는 네트워크 수준 보안이다. DDos, syn flooding 등 네트워크 수준 공격을 탐지 및 차단할 수 있다.

통합 위협 관리, 엔드 포인트 보안 등을 위한 다양한 보안 서비스 도 존재한다.

### 데이터 암호화 서비스

암호화를 하려면 별도 암호화 모듈이 필요한데, 클라우드 서비스 이용 시 이조차 서비스로 암호화 가능하다.
AWS Encryptoin SDK가 대표적. 클라우드 스토리지와 DB에 저장된 데이터를 암/복호화 해줄 수 있따.
클라우드 서비스 사용 시 https 설정 같은 데이터 전송 구간도 자동으로 암호화 시켜준다. (이거 진짜에요???)

### 인트라넷 서비스

외부 접근을 최소화하기 위한 네트워크 구조
기업에서는 보통 이런식으로 외부 공격으로부터 웹서버를 보호한다.
클라우드 서비스에서는 인트라넷을 위한 보안서비스도 제공한다.
VPC(virtual private cloud)를 사용하면 특정 서버를 VPC 안에 위치할 수 있도록 구성할 수 있어 외부접근이 불가능해진다.


