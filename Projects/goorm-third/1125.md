관리자가 전부 관리하는 것이 맞다.
사용자가 어쨌든 잘못된 정보 줄 수 있음.
사용자가 매우 많다면 정보 수정이 원활하게 가능함.
우리 서비스는 사용자 적어서 관리자가 직접 뛰는 게 낫다.
그리고 어차피 다 정부기관임.

ERD
좌표계
공공데이터(설계 참고용)
TMAP to KAKAO

PostgreSQL은 Boolean 지원하더라.


플로우 차트

흠... 해보니 API 끌어다 쓰는 도착 API 밖에 없어서 내가 할 게 없다.

> 개발자를 편하게 해주자.

좌표계 계산을 어떻게 해줘야 할까?
->
GeoEntity라는 기반 엔티티를 상속받는 모든 엔티티에 대해, 좌표계를 확인하고 EPSG:5181로 자동 변환해 DB에 등록하는 AOP가 있어야 한다.
필드에는 물론 EPSG라는 좌표계 필드도 존재하며 위경도도 lat, lng라는 이름으로 존재함.

변환 시점?

스프링에서는 **Entity 저장 시점**을 AOP로 가로채는 방식 두 가지 모두 가능하다.
1. Repository.save() 를 AOP로 인터셉트
2. JPA EntityListener(@PrePersist, @PreUpdate) 사용
AOP 방식이 필요하다면 Repository 계층에 적용하면 된다.

saveAll 처럼 콜렉션 사용할 수도 있다.

이때도 사용할 수 있어야 함.

GPT말로는 AOP가 과하다고 하는데... 엔티티 리스너를 써라?

비교

|항목|EntityListener|AOP|
|---|---|---|
|save / saveAll 모두 자동 적용|O|조건부(직접 처리해야 함)|
|JPA 라이프사이클과 정확히 연동|O|X (리포지토리 메서드 기준)|
|영속성 컨텍스트 단위 적용|O|X|
|엔티티 단위 이벤트 기반|O|X|
|Repository가 API가 아닐 때는 작동 불가|X|O|

---

경로 탐색은 비동기 요청으로 할 거임. 근데 아마 별 효과 없음. 왜? 스프링 웹이라.
그러니까 대기열 등록을 위해 메시징 큐를 사용할 거임. (나중에)
물론 부하가 얼마나 오는지는 모름.
부하 테스트 하려면 예상 사용자랑 시나리오 다 써줘야 함.

노드 하나하나 다 뜯고 경로 요약 VO, List 형태의 노드 VO 다 패킹해서 DTO로 만들어준다.

정보를 얼마나 알려줄건가?
그거 하려면 프론트 존나 써야됨.

