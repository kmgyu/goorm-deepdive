쿠폰 캐싱 전략?
cache aside, write through
장바구니와 동일한 전략
그러나 쿠폰 목록을 조회 시 캐시 웜업을 통해 단건 쿠폰을 같이 가져오도록 설정함.

민성님
토스 결제?
결제 생성 ~ 승인 오래걸림.
버전과 비관적 락을 이용한 동시성 제어

많은 요청 시 lock 요청 바바박. saga 패턴?

---

# 우리 팀 feedback

## 강사님

1차때보다 명확하다.
하고싶은거 했구나
2차때 화면 만들어서 충분한듯.
카프카 같은 것 활용한 게 좋다.
구성이나 발표 같은 것은 노션에? 어딘가에 내용 써놨음.
좀 더 단계적으로 해주면 좋겠다.

3차는 나중에 한당. 결과물 나름 좋은듯?
시간 짧았는데 좀 쳤다.


## Seed 크루

지철님 (팀장)
ppt도 깔끔하고 공부하고 싶은 거 잘 해보신 거 같다.
DDD라는 게 사실은 계층이 나뉘어져 있고 서로 의존이 될 수 밖에 없다. 이게 하나의 마이크로 모델을 가정하고 채택하는 패키지 구조로 알고 있다. 확장을 고려한다와는 정 반대되는 개념이라고 생각했었는데, 어떤 식으로 MSA로 분리되서 확장할 지 궁금하다.

DDD를 두고 도메인 주도라고 하기에는 좀 어폐가 있다.
패키지 구조를 보고서 그렇게 하는 것은 아님. 통신, 어플리케이션, 도메인 이렇게 나뉘고 도메인은 다 섞여있는 모습이다.

수호님
nginx 어떻게 쓰이는 지 잘 모르겠어요 알려주세요
> LB로서 역할을 해줄 수 있기 때문에 위치시켜 놓았다. 지금은 그 역할 안함.



## 매니저님


---

# Seed 크루 발표

CloudPos
온라인 키오스크 & 포스기

유한 상태 머신을 통한 신뢰할 수 있는 장바구니
> 유상 상태 머신이 뭔가요?

매장 내 판매/재고/주문 데이터를 웹 기반으로 통합 관리할 수 있는 판매 관리 플랫폼

기존 키오스크 포스기 : 옛날 기술 앱 기반. 느리고 불편, UI 가독성 떨어짐.
점주 -> 기기 반강제적 구매 -> 웹 기반 자유로운 디바이스 선택 가능

## 목표
1. 웹 기반 간편한 UI 빠른 속도. 키오스크에서 즉각적 반응속도로 고객 경험 증가 목표
2. 실제 서비스 수준 백엔드 구조 경험
3. TTL, 상태 머신(FSM), 모듈 분리 등 실무 기술 반영

## 수행 과정 (설계계)
프로그램 흐름에 대한 설명.
점주와 고객 프로세스 두 가지가 존재.

MVC 패턴
controller - service - repo

개발 숙련도 차이 -> 모듈 기반 개발 전략
1. 도메인 단위 MVC 분리 개발
	- MVC는 다른 MVC를 알지 못한다.
	- 충돌 없이 빠른 개발 진행
	- 팀원 숙련도 차이 극복
> Loosely Coupled 개념인가?

확장성을 과제로 받은 것으로 알고 있음. 모듈화 한다면 물리적으로 서버를 분리할 수 있어 확장에 열려있고 빠르게 개발할 수 있는 장점이 있다.
2. 모듈 간 연결
	- 모듈 분리 시 의존 문제 - api & listener
	- 모듈끼리 직접 의존 시 결합도가 너무 높아짐.
	- 추후 모듈 분리구조 필요.
	- 효과
	- 코드 구조 깔끔, 리팩토링 쉬움
	- 테스트, 분리 배포, 유지보수 쉬워짐.

통신 규칙
- API, Listener 계층을 만들고 해당 계층을 통해 다른 모듈에 의존
- API 인터페이스 : 모듈이 다른 모듈에게 기능 요구할 때 사용
- Listener 인터페이스 : 다른 모듈이 요구한 기능 제공하는 곳
이를 통해 서비스에 전파가 되지 않을 수 있다.

코드 통합 문제? Git flow
- 개발 흐름을 여러 branch로 나누어 각 작업 목적에 맞는 branch를 사용

사용 이유
- 기능 개발/버그 수정/배포를 체계적으로 관리하기 위한 전략
- 5명의 팀원이 각각 개발 -> 안전한 통합 방식
- 개발 작업 효율적 관리를 위해 모든 기능, 버그를 깃헙 이슈로 티켓화

테스트 환경 통합 - 도커
- 동일한 환경에서 개발. 환경 구성 문제 감소.

## 기술 설명

백엔드 - 스프링 부트
프론트엔드 - svelte
DB - MySQL, Redis
또 있었는데 넘어감.

인프라 - 안정적 서비스 1순위, 비용 최적화 2순위
T 시리즈 사용
토큰을 사용한다. 현재 컴퓨터보다 많은 성능을 요구하는 작업이 올 때 감당 가능하다.
Redis는 Elastic에서 사용 시 상당시 비싸다. 그래서 그냥 EC2로 올렸다.
> URI는 LB로 노출. 근데 ELB 썼나?

상품 이미지 저장소는 S3.

IAM 사용자를 이용해 깃헙/도커 CI/CD를 사용한다.
정규화가 숙련도에 방해가 되지 않게끔? 되어있다? 엥?

## 기술
역할
김에스더 - product, inventory
김유정 - cart
안지철 - order, auth
신수호 - payment
안희건 - discount

기술 설명
프로세스 설명이다.
시퀀스 다이어그램이 아니라 플로우 차트를 그려주셨다.

FCM?
결제 중인지, 결제 아닌지 알 수 있는 유한 상태 머신
서로 정보를 모르게 하기 위해 이런 방법을 사용했다.

| ID     | 이름              | 요구사항 내용                                                      | 요청자 | 수용  |
| ------ | --------------- | ------------------------------------------------------------ | --- | --- |
| RQ_001 | 인벤토리 상품 추가 자동화  | 각 인벤토리에 동일 상품 추가 작업                                          | 김민규 | X   |
| RQ_002 | 전체 매장 상품 조회     | 모든 매장에 존재하는 상품 목록 조회                                         | 김민규 | O   |
| RQ_003 | 첫 주문 할인 기능      | 금일 처음 주문한 고객에게 특별할인                                          | 김민규 | X   |
| RQ_004 | 품목 추천 기능        | 가장 많이 주문된 품목을 카테고리별로 사용자에게 추천하는 기능                           | 김민성 | X   |
| RQ_005 | 매장별 발주 기능       | 각 매장당 품목 발주 기능                                               | 김민성 | X   |
| RQ_006 | 장바구니 로컬 스토리지 활용 | 장바구니에 로컬 스토리지 활용해 비로그인 사용자도 장바구니에 상품 추가할 수 있고 로그인 시 그대로 반영되게 | 정준영 | X   |
| RQ_007 | 관리자 대시보드        | 전체적인 정보를 볼수있는 영역이 있었으면 좋겠습니다                                 | 이준원 | X   |
| RQ_008 | 재고 관리 기능        | 재고 관리를 통한 품절 처리기능                                            | 이준원 | X   |
| RQ_009 | 결제 환불 기능        | 매장 고객이 환불할 수 있는 기능                                           | 김민규 | X   |
| RQ_010 | 더치페이 기능         | 분할 결제를 이용한 더치페이 기능                                           | 김민성 | X   |

결과
API 성능을 k6를 통해 테스트 했다.
통합 테스트를 한 것인가?
스프링 풀이 200개 정도를 하는데, 100개 정도 사용해서 실제 사용할 수 있는 것을 얻고자 함.

DB 쿼리 성능
> k6로 한 것인지? 쿼리 성능은 어떻게 측정함?

> 각 도메인 별 MVC를 분리해서 약한 결합을 통해 확장에 열려있도록 만드는 것이 아주 좋은 흥미로웠던 내용이었다.
> 각 도메인 별로 상태 관리 어떻게 해줌?

유한 상태 머신 자체는 장바구니 도메인이 담당을 한다.
다른 도메인은 컨트롤러. 즉각적 반응. 메시지 큐보단 api 이용. 그런 시스템이다. 유한 상태 머신은 오로지 장바구니만 갖고 있고, 오더 도메인이 결제를 알고 있다. api를 갖고 하는 형태?
지속적으로 터치 했을 때만 유지가 된다. 그래서 굳이 polling한다거나 상태 전파하지는 않는다.

> 고객이 계속 접속해있다는 어떻게 알게 되는지?

장바구니 갯수 바꾸기, 페이지 움직이기 등? 조작이 일어날 때. 솔직히 이건 FE 영역인데 생명주기 신호를 보내긴 한다. 어떤 액션이 일어나거나 터치 행위가 있을 때 TTL을 초기화한다.


> 피드백 때 결제 ID 기반 진행 클릭 시 debouncing이 가능
> 멱등성 체크가 백엔드 측에서 일어나는지?

Payment에서 결제를 생성하지는 않는다.
결제 영수증을 만들고 그 토대로 만든다?
이유는 멱등성, 악의적 JSON payment 조작. 그런 문제에 의해 결제 진행 시 Order에서 명세, 주문 만들고 실패하는 취소되는 저장하고 ID 발급.  UL ID 던지고 UL ID 토대로 결제 만들고 상당히 안전하고 신뢰있도록 만들었다.

> 구현하다 한계점이 있긴 했는데 결제 당시 락을 걸어놓는다.
> 병렬로 어떻게 관리하는지?

이건 좀 rough하게 봐야 할 듯
고객이 결제 눌렀을 때 병렬처리 한다지만 I/O 까지는 무조건 기다려야 함. 이거 기반으로 생각해보자. WebFlux가 아니면 비동기 또는 동기식이다. 스프링에서 물리적으로 병렬을 나눈다. 따라서 추가해봤자 의미가 없다. 병렬로 뻗어나간 것에서 더 느려질 수 있다.
JS나 파이썬 같은 비동기 언어라면 가능.
고객마다 스레드를 하나 주다보니 비동기를 넣어준다 해도 복잡성만 올라가고 큰 성능 향상은 없을 것이다. 병렬로 개발한다고 하면 상당히 위험한 선택으로 보인다.

> product와 inventory 각각이 어떤 도메인인지 궁금하다.
> 재고 개념도 없는 것으로 보인다.

재고는 mvp 개념으로 하다보니 뒤로 밀려났다.
product는 상품 정보. inventory가 묶이는 이유는 어떤 매점에서 쓰이는지? 거의 필연적으로 묶이게 된다. 서로 다른 성격임에도 분리를 한다고 해도 이득이 없는 도메인으로 봤다.
inventory가 product를 감싸는 식으로 설계.

> 굳이 Redis를 활용한 이유가 무엇인지? 성능 향상 목적인지...?
> TTL 설정도 나와있었는데, 어떤 식으로 했는지 궁금하다.

스프링의 성격에 대해 이해해야 한다.
Redis를 사용하지 않으면 지역변수로 Map을 사용하게 된다. 보이는 것은 24시간 돌아가는 것처럼 보여도 요청이 오면 새로운 스레드로 뻗어간다.
데이터를 컬렉션에 저장하면 JVM이 이걸 GC에 넣어서 결과론적으론 저장이 안된다. 그래서 공유가 안됨. 전역적 스레드로 공유가 되는 맵이 있긴 한데 이거 쓰면 된다. 
근데 사실 지양하는 패턴이다. 메모리가 계속 잡히고 힙메모리 사용해서 JVM의 성능을 상당히 감소시키는 효과가 있다.
고객 편의성을 위해서 이걸 구현하려 하면 상당히 힘들 것.

Redis는 item에 변경이 없을 때 몇초 내에 사라진다. 그러나 요청이 오면 몇 초 유예 된다. 라는 기능이 있음. JVM, 스레드 로컬 문제 해결. 방치된 장바구니도 닫는 역할을 수행할 수 있다.



## 강사님 feedback

성격 차이가 느껴진다. 1조는 해보고 싶은 거 했다. 굳이 상황에 맞지 않아도 추라이 해본 것. 2조는 발표에서 잘 안 묻어간 것처럼 포장을 했다? 뭐지? 돌려까기인가? 각 팀원의 실력 차를 메꿨다 라고 포장한 것이 좋다. ppt 디자인 심플하게 해둔 거 좋았다.
1조는 어쩔 수 없당.

---

시간이 없다면 부랴부랴 ppt 만들어서 초점 안 맞게 하는 팀들이 많다. 이번 팀들은 잘해주었따?

Seed 크루 팀은 기초적 설명만 했다. 시간이 부족하기 때문에, 그 정도 레벨은 생략해도 된다. 용어나 표현에 대한 것들을 줄이고, 페이지는 없애지 않아도 된다.

우리 팀은 서비스에 대한 설명이 비교적 적었다.


개발자 사회력 높이기 교육을 해주셨다.

5시 40분 복귀

---


3차 발표 생각해보기
지도 API 이용해서 생각해보자.
Ticker 프로젝트? 프론트에 표시하는 거니까 이거 하기 많이 힘들듯

---

DDD 단점
어디에 어떤 클래스 있는지 찾기 힘들다.
개발 양식이 조금씩 달랐다.


---

데이터 시각화, FE 개발은 안해도 되긴 하는데 안하면 좀 애매하다.

Summary 장표가 있으면 좋을 것 같음.