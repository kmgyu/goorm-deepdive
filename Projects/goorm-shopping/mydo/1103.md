> 하루 일과 종료 공유 시 노티할 내용

### credential 추출
jwt provider에서 get email로 가져올까 get authentication 가져올까
후자는 db io가 발생하지만 보안 신경쓴다.

근데 어차피 email 가져오더라도 fk가 userid라 db io는 두번 발생한다.
get authentication 사용한다.

사실 필터 체인에서 검증한 채로 Authentication 객체를 주기 때문에 컨트롤러 측에서 직접 추출하지 않아도 된다고 한다.

Authentication 클래스 매개변수를 넣어주면 자동으로 채워진다.

더 간결한 표현식을 준원님이 제공해주셨다.
```
@AuthenticationPrincipal(expression = "user") User user
```

### 날짜 검증하기

날짜 검증은 어떻게 해줄까?

Instant라는 시간 측정 클래스로 최대한 간결하게 파싱해주었다.

분단위 오차만 요청에서 허용하도록 하였는데, 성능 요구사항에 따라 달라지는 정책이므로 2차에서 하도록 한다.


### 쿠폰 만료일 정책

이거 정책 기준을 설정해주어야 함.
현재는 날짜까지만 하고, 만료 시간을 00시 00분으로 설정하였음.
따로 구체적으로 설정해주지 않는다면 정책은 이것으로 확정해주어야 할 것 같음.

정책 관련 사항에 대한 문서도 추가해야 할 것 같음.
일단, 점심 때 만들어보고 공유해보자.


### JPA Many2one 관계

쿠폰 발급 (Coupon Issue) 엔티티 필드
이거 ORM 다운 객체 매핑을 안해줘서 수정을 해주었다. 쿠폰은 연결됨.
UserJpaEntity가 있던데, Many2One 관계 이어줄 때 엔티티 객체로 이걸 이어줘야 한다. 근데 이걸 반환하는 메서드를 못 찾은 것 같다.
일단 지금도 사용은 가능해서, 따로 객체 매핑을 안시켜줘도 동작은 할 수 있다. 현재로서는 불편함을 느끼는 단계는 아니다.
2차 때 리팩토링 해볼 수 있을 듯.

> 이거 외에도 쿠폰 쪽 추가 개선 해주고 있다.
> 이슈로 올렸으니 확인 가능

### Exception 명칭 문제

짝프로그래밍 프로젝트에서 소스를 몇 개 긁어왔다.

일단 BusinessException으로 설정함.
내가 새로 브랜치 파둠
이거 어떻게 해둘까ㅃ셔ㅛㅇ
한 번 둘러보고 맘에 안드는 부분 있으면 짚어주시면 반영해보겟슴
하고 나서 PR 날릴 예정. ErrorCode 같은거 본인 도메인 추가해주시면 됀다.

정책적인 부분이 조금 있긴 한데 에러코드도 규칙을 좀 정해봤다.

이름은 UPPERCASE로 작성하고, 공백 문자 대신 `_`로 대체한다.
`DOMAIN__CAUSED_BY` 형식이 제일 적절할 것 같다. 도메인과 원인을 `__`로 분리함.

HttpStatus에서 가장 적합한 것을 넣어주고, 메세지 적어줌.
상세 메시지가 필요한 경우, BusinessException 생성 시 더 디테일한 메시지를 작성해줄 수도 있음.

일단 확인해보고 괜찮은 것 같으면 문서화 해두겠음.


