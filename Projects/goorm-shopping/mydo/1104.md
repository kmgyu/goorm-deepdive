쿠폰 사용 흐름

장바구니 결제 측에서 couponId, 결제 비용(cost)로 요청

쿠폰 검증중~
couponId 조회, 비용에 따른 할인 정책
- 현재는 아마 if문으로 해줄 듯 싶은데 2차 때 전략 패턴으로 리팩토링 해줄 거 같음.
- 기술 부채 달아두기

estimateDiscount?
useCoupon?

completeCoupon


결제 완료
일단 결제 완료할 때랑 쿠폰 사용할 때의 메서드를 다른 것을 써줘야 할 것으로 보임.
결제가 완료되면 쿠폰도 같이 사용을 했다라는 메서드를 주면 좋을 듯.

중간에 트랜잭션 실패하면 얘네가 구분안해줘서 롤백할 수도 있나 걱정해봤는데 이렇게됨.
1. A에서 B 호출
2. B 완료 
3. A에서 B의 다른 메서드 호출 
4. B 실패
일단 gpt 말로는 이때 서비스의 트랜잭션 전부 롤백한다고 함.

order 쪽에서 쿠폰 여러 개 적용 가능
쿠폰 여러 개는 리스트 형태로 관리할 예정 (order와는 연관관계 없음!)

기술 부채
dto? vo? 아무튼 리스트로 담아줄 거 생각해주기

전략패턴?
일단 리팩터링은 나중에 생각하자

---

발표용 자료들

템플릿 완성 얘네 자기네 템플릿 쓰지말라고 함. 1차 이후에도 이거 활용하면 될 것 같음. 구글 스프레드 시트로 공유하겠음.

발표 자료에 들어갈 목록
산출물
- 기획안
- 시퀀스 다이어그램 및 플로우
- ERD
- 프로젝트 개발 환경
	- 도커 컴포즈 이미지 구조
	- 깃 리포지토리
앞으로 발표자료 같은 것도 계속 관리해두겠음.

---

수업 이후에 발생한 이슈들

준영님
product? 해제하지 않았으나 엔티티 vo 설정이 해제됨.

민성님
스키마, 구조 잡는 것이 나았을 듯
domain/product 날림.

문제점?
1. 기존 민성님이 작업한 product 도메인 코드가 오염되서 현재 repository, controller, 서비스로직, dto, vo, 엔티티 생성이 동작x
=> 기존 작업하던 product 도메인을 날리고 현재 동작하는 준영님의 product 도메인을 활용하는 것이 좋을 것 같다. 중간에서 바꾸면 카프카쪽을 많이 수정하셔야 할 수도 있고 더 꼬일 수도 있을 것으로 보임.

2. Order 도메인 로직을 기존 product를 활용하려고 생각하고 접근하니 현재 기존 도메인이 동작하지 않는 문제 존재
=> Order는 재고 차감만 하지 않고 다양한 주문 기록 및 payment, coupon, raffle, cart 도메인과 연결되야 함.

todo? dev 기준

1. 현재 준영님의 product가 api 명세서 상의 /product 의 기능들을 제공하는지 확인
2. 기존 저의 Product 도메인을 제거하여 정상적으로 동작하는지 확인
3. product의 uuid를 리스트로 주었을때 product의 각 정보를 반환하는 기능을 product repository에 구현 : Order 도메인 구현시 필요

준영님의 product 엔티티 기준으로 order, payment 작업 진행하겠다.
