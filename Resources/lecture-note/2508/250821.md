태스크
파일업로드
완료하지 않아도 상관은 없다.

브랜치가 두개지요
태그가 존재함
conversion? gradle 시점
auth-complete? 로그인/로그아웃
file-upload-complete? 파일 업로드 -완-

태그를 만들면서 브랜치를 만들어 체크아웃하는 개념?
태그 누르면 그 시점 소스들이 나오게 된다.

---

파일 업로드
멀티파트 폼

스프링에서는 받아줄 때 MultipartConfig을 써줘야 함
데이터 받는 방식도 Part라는 파일 파트로 받아오고...
근데 스프링 부트에서는 더 간단해져서 다른 패러미터처럼 @RequestParam으로 받아줌.

로직 상 중요한 체크포인트
파일 존재 여부 체크
파일명 처리
보안 검증 3단계
1. 확장자
2. 파일 크기
3. 경로 보안
파일 저장 경로
파일명 중복 처리
파일 크기 제한
경로 보안

업로드 파일이 프로젝트 경로에 쌓이게 되면 WAR에 싸면 날라간다.
그래서 소스코드 위치 외부에 넣는게 정석
main 폴더에 넣어야 한다? 프로젝트 루트 폴더? main/java부터 소스코드로 치남
파일 같은 경우, 외부에 있을 때 웹에서 접근할 수 있는 경로에 두면 제어할 방법이 없다.
이미지 파일은 웹 직접 접근, 중요 파일은 컨트롤러 경유 다운로드 식으로...


파일 다운로드 정책, 파일 삭제 시 주의사항 등... 중요한 게 많다.

xss 방지 방법?
jsp 출력 이스케이프
서블릿 필터를 통한 전역방지

자주 놓치는 XSS 취약점
출력 이스케이프 누락
js 내부데이터. js 변수에 직접 삽입보다 dom 조작으로 안전하게 삽입하는 것이 좋다. 이스케이프가 제대로 되지 않을 경우 XSS가 삽입될 수 있다.
url 파라미터 출력

에디터 사용 시 필터 우회
리치 에디터 등에서는 html 태그 사용필요, xss 팰터가 모든 태그 제거
1. 특정 필드만 필터 제외
2. 화이트리스트 태그 허용
   안전한 태그들만 허용해준다. `p`, `br`등... 제일 위험한 건 `script`
3. html sanitizer 라이브러리 사용
4. 에디터 레벨에서 제한
   허용 태그 같은 거....

---

실습?
사진 이미지 삭제해도 안보인다. 삭제 끝나면 dom 영역 클리어 시켜줘야 하는데, 그게 안됨. 그거 추가해줄 것.
첨부파일도 여러개 올릴 수 있음
다운로드 누르면 창 뜨고 다운하면 나온다.

톰캣이 보여지는 경로?
외부 소스는 어떻게 연결해줄까?
톰캣에서 배포할 때, 외부 경로를 context로 추가해주면 해당 경로가 추가된다.

좋은 것을 보여주지
야광 톰캣이다.

1:N 관계
게시판 테이블과 첨부 파일 테이블 관계
어... 뭘 설명하신 건지 모르겠다. 다시 봐야 함.
file upload할 때 1:N 관계 prepare statement?
2:01분까지 설명해주심
매핑되는 거 어노테이션 설명해주신듯

태스크
테이블 만들어야 함 참고

gitignore 추가
리소스 업로드 프로퍼티?
물리적 위치
앞부분을 본인 위치로 맞춰주기
db config url


upload 폴더는 src 밖에 두거라
war 대상 밖?
루트폴더니까 엄...
아무튼 경로는 upload properties에 있으니 프로젝트에 맞게 수정하 ㄹ것

배포에 외부 소스 추가는 context path를 추가해주는 행위

업로드는 동일.
일반과 대용량의 차이가 있다. 내일은 이론적인 것 설명 예정
검색 쿼리
리치 텍스트 에디터