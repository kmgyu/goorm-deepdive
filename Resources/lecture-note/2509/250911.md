MyBatis의 동적 쿼리 만들어 볼 것?

다중 버전 DB 만들기가 어제 해본 것
h2 및 마리아DB

properties 같은 환경 세팅은 운영파트와는 룰이 달라서 다 다르게 세팅해야 한다? 회사마다 다르긴 하다고 함.

어제 하던 거 페이징

페이징은 나중에 공통모듈로 뺄 것. pageable 인가? 아니면 새로 만드려나?
페이징이 추가되면 MVC 영역 다 바뀐다. 어떤 메서드나 라이브러리 바뀌는 지 확인해야 함.

MyBatis의 경우, 쿼리도 수정 필요. limit 처럼

오늘 할 쿼리
Search
페이징과 동일하게 전부 바뀌게 될 것


전체, 제목, 내용 등 검색에 옵션을 줄 수 있음.
그래서 `<if>`, `<choose>`, `<when>` 태그 사용해서 동적 쿼리 만들어낸다.
jpa랑 하는 일은 똑같다. 조건들이 들어가기 때문에 동적으로 조건 추가

핸들러 메소드부터 매퍼까지 전부 패러미터 바뀐다.

lower() 해주면 대소문자 구분 안 함. 안 좋을 수 있음.

where 1=1이라는 쿼리를 볼 수도 있다.
where 태그가 생기기 이전 만들어졌던 잔재
where절 자체가 존재하지 않으면 동적 쿼리 조건만 추가돼서 문법적 오류가 생기게 된다. 편법임.


리스트 기능에다 검색 기능 통합하면서 그냥 기존 거에 패러미터 추가함.
메서드를 나눴다.
근데 메서드 오버로딩 하면 안됨?

질문
실무에서는 검색 조건처럼 추가적인 조건이 붙는 경우 메소드 오버로딩보다는 접미사로 ~WithOptions나 ~ByOptions 와 같이 명시해두는 경우가 더 많나요?

상황마다 다름
많다 아니다라고 하기 애매하다.
개념적으로은 메소드가 변경되면 기존에 사용하던 메소드의 형태가 달라지니까  
이미 사용하고 있는 메소드라면 기존의 호환성을 위해 메소드가 추가되는게 맞다.
현실적으로 설계에 있던 OOP 철학이나 클린코드가 깨질 수 있다.
접미사 등을 붙이냐 아니냐는 메소드 의미를 명확하게 하기 위한 것에 가깝다.
철학을 유지한다면 동일 이름으로 가는 것이 좋긴 함.

기능에 패러미터를 계속 추가할 수록 이게 뭐하는 건지 모호해지게 된다.
두 가지가 절충이 돼서 현업에서 정해진다.
정답은 항상 없다.

하지만 네이밍은 잘해줘야 한다.
OOP와 클린코드 사이에서 갈팡질팡하는 것임

클린 코드 관점에서 봤을 때 패러미터로 String search 형태로 준다던지, Pageable과 같은 객체 형태로 값을 전달할 때 오버로딩을 어느정도 유지해줄 수도 있다.
여러가지 검색 옵션의 경우 Search라는 객체같은 걸로 옵션을 담아줄 수도 있음.

구체적인 요구사항을 요구하지 않았는데 너무 많은 것을 고려하는 것은 좋지 않다.
아직 의미가 없는 불확실한 상태이기 때문.
현재 상황에서 오버해서 생각하게 되면 크기가 커져서 결국 못하게 됨.

duplicate annotation같은 것도 쓰는 놈이 있으니까 못 없앰
지금 시점에서 잘못된 상황이라...
네이밍은 구조다.


정리하는 단계 추가. 내일 해볼 예정
다음주 초부터는 stock 만들어서 세팅해보고 추가하는 식으로 진행 예정



코드 비교 도구
IDE인 인텔리제이에서 지원
윈도우즈는 WinMerge같은 것으로 비교가능


---

MyBatis ${} 문법?
prepareStatement는 ? 대입
`#{}`는 prepareStatement와 동일한 문법

계속해서 기능이 늘어나면 xml에서 쿼리가 늘어난다.
개발할 때는 애러가 나지 않는다. 그래서 MyBatis Generator 형식으로 테스트 뽑아내보기 해본다...?