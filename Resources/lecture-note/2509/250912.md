
xml의 맹점
런타임에 에러 발생

mybatis 옵션
map-under-score-to-camel-case
카멜 케이스를 스네이크 케이스로 자동 변환해주는 것
xml에서는 쿼리 쓸 때 스네이크케이스 써줘야 함.

useGeneratedKeys, keyProperty?
Auto increment 값을 가진 타입에서 사용
그래서 insert 시 해당 타입 넣지 않음
넣어주면 insert 시점에서는 id를 알 수 없지만, DB에서 반환받을 때 insert된 id를 알 수 있다.

${}는 sql insection 위험 존재
`#{}`를 쓰는 것이 안전하다고 함.
prepared statement와 statement의 차이라고 보면 된다?

`select * from posts.${year}` 이런 곳에서는 쓴다.
orderby같은 동적 쿼리에서도 제한적으로 사용됨.


where 절에 통으로 집어넣는 것도 위험하다.

테이블 명이 가변적인 경우
order by
in 쿼리
3가지 정도에서 ${} 사용에 대한 고민이 필요함.
이거 아니면 왠만하면 절대 써서는 안된다.

countWithSearch, findWithSearch의 경우 검색 조건이 같아야 하기 때문에 where 절 및 그 이하가 같거나 유사할 것이다.
이런 중복되는 절을 분리해서 독립시킬 수 있다.
refId 같은 것으로 다시 붙여둘 수 있음...


ResultMap 매핑
컬럼과 필드 간의 매핑을 명시적으로 정의
복잡한 객체 구조와 연관 관계 처리 가능
컬럼명과 필드명이 달라도 매핑 가능

테이블 컬럼이 프로젝트 룰에 의해 일반적인 관례를 따르지 않을 경우 사용한다.
직접 각 컬럼과 엔티티 필드를 명시하는 방식이다.

실제로는 두 방식을 적절히 혼합해서 사용한다.
클래스로 정의된 것을 사용하느냐, 커스텀으로 정의한 것을 사용하느냐의 차이?

복잡한 상세 조회 같은 쿼리 사용 시 쓸 수도? 있다.

---

클래스 리팩토링

조회수 업데이트

한땀한땀 보면서 칠 것
이미 한땀한땀 치다가 박살났는데요?
레볼루숑~ 커서 쓰며 고치기~ 야호~
아니 컴포넌트 기반인 거 어거지로 패키지 구조 바꾸니까 다 박사ㅣㄹ났어

제너레이터는 월요일에 해도 상관 없을 듯

월요일부터는 진도 파악할 예정
