QueryDSL repository
jpa는 동적 쿼리가 제한적이었다.
query method를 사용하면 제한적이며, JPQL을 사용할 경우 쿼리가 복잡해졌다. native sql을 사용할 경우 특정 db에 종속적이게 될 수 있다는 문제점 또한 존재하였다.
문자열로 작성되기에 타입 안정성 또한 낮았다.
리팩토링, 재사용성, IDE의 자동완성이나 문법 검사 제한 등... 단점 추가 존재

Criteria API를 대안으로 선택할 수 있었다.
JPA 사양의 일부로서, 타입 세이프하게 사용할 수 있다.
그러나 QueryDSL이 나오면서 버려졌다고 한다.

따라서 QueryDSL로 간단하면서 타입-세이프하게 구현할 수 있다.


jpaRepository는 hibernate로 구현되었음.
queryDSL의 경우, 클래스로 선언되어 그 자체로 구현체이다.

```java
// JpaRepository 상속 (기본 CRUD)
public interface EnrollmentRepository extends JpaRepository<Enrollment, Long> {
    // Query Methods
    List<Enrollment> findByStudentAndCourseAndDeletedFalse(User student, Course course);
}

// QueryDSL 전용 Repository (복잡한 쿼리)
@Repository
public class EnrollmentQueryRepository {
    private final JPAQueryFactory queryFactory;
    
    public EnrollmentQueryRepository(EntityManager em) {
        this.queryFactory = new JPAQueryFactory(em);
    }
    
    // QueryDSL로 복잡한 동적 쿼리 작성
    public Page<Enrollment> searchByAdminConditions(...) {
        // QueryDSL 코드
    }
}
```


QueryFactory

QueryDSL에서 타입 safe한 쿼리를 생성하고 실행하는 팩토리
EntityManager를 래핑하여 QueryDSL 기능을 제공함.

```java
@Repository
public class EnrollmentQueryRepository {
    private final JPAQueryFactory queryFactory;
    
    public EnrollmentQueryRepository(EntityManager em) {
        this.queryFactory = new JPAQueryFactory(em);
    }
    
    public List<Enrollment> findAll() {
        return queryFactory
            .selectFrom(enrollment)  // Q클래스 사용
            .fetch();                // 쿼리 실행
    }
}
```

복잡한 정책 쿼리에서 이것을 사용 가능.


---

JPQL은 사용 시 인덱스 힌트를 부여 가능. (native query)
그러나 DB에서 인덱스를 사용하지 않을 경우 오류가 일어날 수 있다.
따라서 지양하는 방식이라고 함.
```java
// MySQL 인덱스 힌트
@Query(value = "SELECT /*+ USE_INDEX(board, idx_title) */ b FROM Board b WHERE b.title LIKE %:keyword% AND b.deleted = false", 
       nativeQuery = true)
List<Board> findByTitleWithIndexHint(@Param("keyword") String keyword);
```

---

이슈
단방향 관계 CUD
커리큘럼 팝업 구현?
편의 메서드


---

일반 서버, 도커 배포로 한다고 함.
AWS 안한다?