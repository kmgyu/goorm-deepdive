네트워크 구성

SNS 등장 전후로 나뉨
대규모 B2C 서비스다 보니 무중단 배포

배포에는 두 가지 방식 존재
jar 파일 배포 방식
jar 파일을 서버에 올려 서버에 실행 명령

---

ftp의 경우, 보안 취약점으로 인해 sftp를 사용해야함.
여기서도 https처럼 ssh를 사용해야 한다.

ftp를 통해 로컬에서 배포한다.
파일질라 활용


---

오후 실습

로컬 서버에서 실습한다.
카페24등의 호스팅같은 걸 쓸 수 없으니 로컬 컨테이너로 논리적 서버 구축하는 것임

docker network를 사용해 네트워크 통신 사용
컨테이너 간에 통신을 할 수 있도록 로컬 네트워크를 제공하는 기능.

appnet-practice를 사용했다.

docker network 등록
```
# (처음 한 번만) 네트워크 생성
docker network create appnet-practice
```

신규 컨테이너는 다음과 같이 등록시킬 수 있다.
Linux
```
docker run -d \
  --name deploy-server \
  --network appnet-practice \
  -p 2222:22 \
  -p 8081:8080 \
  -v deploy-data:/home \
  ubuntu:22.04 sleep infinity
```
Windows는 `\` 제거해주자.

기존 컨테이너는 이렇게 등록시켜줄 수 있다.
```
# MariaDB 컨테이너를 네트워크에 연결
docker network connect appnet-practice mariadb-container
```

### ssh 연결

연결 전 ssh 대몬을 미리 실행시켜줘야 한다.
```bash
/usr/sbin/sshd
```
좀 귀찮음...


```bash
ssh -p 2222 root@localhost
# 비밀번호: admin1234

# 또는
ssh -p 2222 was@localhost
# 비밀번호: 1234
```

### SFTP
ex. filezilla
```
호스트: localhost
포트: 2222
프로토콜: SFTP
사용자명: was (또는 root)
비밀번호: 1234 (또는 admin1234)
```

app directory 준비
```bash
sudo -u was mkdir -p /home/was/app /home/was/app/config /home/was/app/logs /home/was/app/backup
ls -la /home/was/app
```


File zilla에 파일을 올려 ssh로 컨테이너에 접속해 jar를 실행해준다.


